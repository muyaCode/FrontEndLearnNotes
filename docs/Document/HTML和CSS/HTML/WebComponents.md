# WebComponents

æ–‡æ¡£ï¼š[Web Component|MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/Web_components)

æ•™ç¨‹ï¼š[å‰ç«¯éœ€è¦æ‡‚çš„çŸ¥è¯†- Web Components çš„ä½¿ç”¨](https://www.nowcoder.com/discuss/514477909449498624)

[Web Components åŸºç¡€å…¥é—¨-Web Components æ¦‚å¿µè¯¦è§£ï¼ˆä¸Šï¼‰](https://juejin.cn/post/6969341653760868360)

[Web Components åŸºç¡€å…¥é—¨-ç”Ÿå‘½å‘¨æœŸï¼ˆä¸­ï¼‰ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6969342045135568903)

[Web Components ç›¸å…³æŠ€æœ¯åŸºç¡€ä»‹ç» (ä¸‹) - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6972472688254124062)

[69 è¡Œä»£ç  å®ç°ä¸€ä¸ª vueã€reactã€san è¶…å¥½ç”¨é€šç”¨ table ç»„ä»¶ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7299354483557072935)

[äº”åˆ†é’Ÿå¸¦ä½ äº†è§£ Web Components](https://zhuanlan.zhihu.com/p/580540604)

[äº†è§£ Web Components](https://www.jianshu.com/p/091a8fa9fcc5)

[ç¢ç‰‡åŒ–å­¦ä¹ å‰ç«¯ä¹‹ HTMLï¼ˆwebComponentï¼‰ - æ·±å··é…’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/huangminghua/p/17387582.html)

[Web æ€§èƒ½æ—¥å† Â» ä½¿ç”¨ HTML Web ç»„ä»¶æ‰©å±•å“åº”å¼è§†é¢‘ (perfplanet.com)](https://calendar.perfplanet.com/2023/extending-responsive-video-with-html-web-components/)

## Web Components ç®€ä»‹

Web Components æ˜¯æµè§ˆå™¨ç”¨æ¥åŸç”Ÿæ”¯æŒâ€œç»„ä»¶åŒ–â€çš„æ–¹æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæŠ€æœ¯ç»„æˆä¸ºï¼š

- **HTML templates**ï¼šHTML æ¨¡æ¿
- **HTML Imports**ï¼šå¯¼å…¥ HTML æ¨¡æ¿
- **Shadow DOM**ï¼šå½±å­ DOM
- **Custom Elements**ï¼šè‡ªå®šä¹‰å…ƒç´ 

Web Components å°±æ˜¯æä¾›æµè§ˆå™¨åº•å±‚çš„æ”¯æŒï¼Œä¸ä¾èµ–å„ç§æ¡†æ¶çš„æ”¯æŒå’Œ webpack çš„ç¼–è¯‘ï¼Œè®©æˆ‘ä»¬ä¹Ÿèƒ½ä½¿ç”¨ç»„ä»¶ã€‚

Web Components é€šè¿‡ä¸€ç§æ ‡å‡†åŒ–çš„éä¾µå…¥çš„æ–¹å¼å°è£…ä¸€ä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶èƒ½ç»„ç»‡å¥½å®ƒè‡ªèº«çš„ HTMLã€CSSã€JavaScriptï¼Œå¹¶ä¸”ä¸ä¼šå¹²æ‰°é¡µé¢ä¸Šçš„å…¶ä»–ä»£ç ã€‚

## ç›¸æ¯”æ¡†æ¶

2011 å¹´æå‡º Web Componentsï¼Œä¸ºäº†è§£å†³ä»£ç å¤ç”¨é—®é¢˜ï¼Œæ—©äº Reactã€Vueï¼›

ç›¸å¯¹äº Reactã€Vue ç»„ä»¶ï¼ŒWeb Components æ˜¯åŸç”Ÿç»„ä»¶ï¼Œä¸é™åˆ¶æ¥å…¥æ–¹çš„æŠ€æœ¯ï¼Œå¯ä»¥æ¥å…¥åˆ° Reactã€Vue ç­‰æŠ€æœ¯æ¡†æ¶ä¸­ã€‚

## å›°å¢ƒ

- å…¼å®¹æ€§ä¸è¶³ï¼Œéœ€è¦ä¸»æµæµè§ˆå™¨çš„æ”¯æŒï¼Œéœ€è¦å¹³ç¼“çš„è¿‡æ¸¡
- æ²¡æœ‰æ ‡å‡†çš„æ•°æ®ç»‘å®šæœºåˆ¶ã€åœ¨å¤„ç†è‡ªå®šä¹‰å…ƒç´ å†…éƒ¨æ•°æ®ã€UI æ›´æ–°ã€ç»„ä»¶é—´å‚æ•°ä¼ é€’æ—¶ä¸å¤Ÿä¾¿æ·å’Œå‹å¥½ï¼Œç›®å‰æ¥çœ‹å¤§å¤šè¿˜ä¾èµ–äºæ“æ§ dom å»å®ç° UI æ›´æ–°

## HTML templatesï¼šHTML æ¨¡æ¿

æ”¯æŒ template æ ‡ç­¾å’Œ slot æ ‡ç­¾ã€‚slot æ ‡ç­¾æ”¯æŒåŠ¨æ€æ›¿æ¢æ¨¡æ¿ä¸­çš„ HTML å†…å®¹ï¼Œå®ƒç”¨ name å±æ€§æ¥ä½œä¸ºå”¯ä¸€è¡¨ç¤ºã€‚template ä¸­çš„å†…å®¹è¢«æ’å…¥åˆ° DOM ä¹‹å‰ï¼Œä¸ä¼šæ¸²æŸ“ï¼Œå®ƒå¯ä»¥æ”¾åœ¨ document ä¸­çš„ä»»ä½•ä½ç½®ã€‚

`<template>`ï¼šåŒ…å«ä¸€ä¸ª html ç‰‡æ®µï¼Œä¸ä¼šåœ¨ html åˆå§‹åŒ–æ—¶æ¸²æŸ“ã€‚ä¸»è¦ä½œç”¨æ˜¯ï¼šé€šè¿‡ JavaScript è·å–è¯¥ä»£ç ç‰‡æ®µå°†å…¶æ”¾å…¥è‡ªå®šä¹‰æ ‡ç­¾å†…æ˜¾ç¤ºï¼Œä¸»è¦ä½œç”¨äºè‡ªå®šä¹‰æ ‡ç­¾

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<template id="test_template">
			<div class="container">
				<span class="test_custom">è‡ªæµ‹è‡ªå®šä¹‰æ ‡ç­¾</span>
			</div>
		</template>
		<custom-button></custom-button>
		<script>
			class CustomButton extends HTMLElement {
				constructor() {
					super();
					const dom = document.querySelector("#test_template").content;
					this.append(dom);
				}
			}
			customElements.define("custom-button", CustomButton);
		</script>
	</body>
</html>
```

æµè§ˆå™¨æ‰“å¼€ï¼Œç„¶åè°ƒè¯•ï¼Œå†å…ƒç´ (Elemenets)æ ‡ç­¾ä¸Šçœ‹ï¼Œè‡ªå®šä¹‰æ ‡ç­¾çš„å­—æ®µ

æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ç§å†™æ³•ç›¸å¯¹äºå‰ä¸€ç§æ–¹å¼ï¼Œæ›´åŠ `æ˜“è¯»`ä»¥åŠ`ä¾¿æ·`

`<slot>æ’æ§½`ï¼šç»™æ¨¡æ¿å…ƒç´ ä¼ å€¼ï¼Œå¢å¼ºæ¨¡æ¿å…ƒç´ çš„çµæ´»æ€§å’Œé€šç”¨æ€§ã€‚ slot åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å…·å¤‡ä»¥ä¸‹ç‰¹æ€§

- å¿…é¡»åœ¨å½±å­ Dom ç§ä½¿ç”¨ï¼Œå¦åˆ™ä¸å…·å¤‡æ’æ§½çš„æ•ˆæœ
- ç»™ Slots ä¼ å€¼çš„å…ƒç´ å¿…é¡»æ˜¯è‡ªå®šä¹‰å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼Œå¦åˆ™ä¼ å€¼å¤±æ•ˆ

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<template id="test_template">
			<div class="container">
				<span class="test_custom">è‡ªæµ‹è‡ªå®šä¹‰æ ‡ç­¾</span>
				<slot name="userName" slot="userName"></slot>
			</div>
		</template>
		<custom-button>
			<div class="name_cls" slot="userName">å¼ ä¸‰</div>
		</custom-button>
		<script>
			class CustomButton extends HTMLElement {
				constructor() {
					super();
					const dom = document.querySelector("#test_template").content;
					this.append(dom);
				}
			}
			customElements.define("custom-button", CustomButton);
		</script>
	</body>
</html>
```

é€šè¿‡ä»£ç å…ƒç´ è°ƒè¯•å‘ç°ï¼šæˆ‘ä»¬æ’å…¥çš„`<div class="name_cls">å¼ ä¸‰</div>`å¹¶æ²¡æœ‰æ’å…¥åˆ° container èŠ‚ç‚¹å†…ï¼Œä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬çš„ slot æ²¡æœ‰ç”¨åœ¨å½±å­ dom ç§ï¼Œæ‰€ä»¥æµè§ˆå™¨å°†`<div class="name_cls">å¼ ä¸‰</div>`å½“æˆå…¶æ­£å¸¸çš„å…ƒç´ è¿›è¡Œæ¸²æŸ“äº†ï¼›

```html
<script>
	class CustomButton extends HTMLElement {
		constructor() {
			super();
			const shadow = this.attachShadow({ mode: "closed" });
			const dom = document.querySelector("#test_template").content;
			shadow.append(dom);
		}
	}
	customElements.define("custom-button", CustomButton);
</script>
```

å½“æˆ‘ä»¬å°† slot æ’å…¥åœ¨å½±å­ domï¼Œå¯ä»¥å‘ç° slot ç”Ÿæ•ˆäº†ï¼›

å¦å¤–éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹ï¼Œå½“ä½¿ç”¨ slot çš„æ—¶å€™ä¸‹è¾¹è¿™ä¸ªç”¨æ³•æ˜¯é”™è¯¯çš„

## HTML Importsï¼šå¯¼å…¥ HTML æ¨¡æ¿

æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå°† template çš„å†…å®¹å†™åˆ°ä¸€ä¸ªæ–°çš„ main.html æ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡ link å¼•å…¥ã€‚

```html
<head>
	<link rel="import" href="./main.html" />
</head>
```

## Shadow DOMï¼šå½±å­ DOM

Shadow DOM æä¾›äº†ä¸€ç§å¥å£®çš„å°è£…æ–¹å¼æ¥åšåˆ°é¡µé¢èŠ‚ç‚¹çš„éš”ç¦»ï¼Œé¿å…å…¨å±€æ ·å¼å†²çªï¼Œè¿™ä¹Ÿæ˜¯ Web Component çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚

æµè§ˆå™¨æä¾›äº†ä¸€ç§æœºåˆ¶ç”¨äºéš”ç¦»ä¸€æ®µä»£ç å’Œå¦ä¸€æ®µä»£ç ï¼Œè¯´åˆ°è¿™é‡Œä½ è‚¯å®šæƒ³åˆ° iframeï¼Œä½†æœ‰æ—¶å€™ iframe ä¼šæ˜¾å¾—éå¸¸çš„æ²‰é‡ä»¥åŠéš”ç¦»äº†å¤ªå¤šï¼Œå¯¼è‡´æˆ‘ä»¬ä½¿ç”¨èµ·æ¥éå¸¸çš„éº»çƒ¦ï¼› æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ shadow root å°† CSS å’Œ HTML ç»‘å®šåœ¨ä¸€èµ·å°è£…æˆç»„ä»¶ï¼Œå¹¶ä¸”å…¶æ”¯æŒå¤©ç„¶çš„æ ·å¼éš”ç¦»ï¼›

**`Element.attachShadow()`** æ–¹æ³•ç»™æŒ‡å®šçš„å…ƒç´ æŒ‚è½½ä¸€ä¸ª Shadow DOMï¼Œå¹¶ä¸”è¿”å›å¯¹ [ShadowRoot](https://developer.mozilla.org/zh-CN/docs/Web/API/ShadowRoot) çš„å¼•ç”¨ã€‚

```html
<script>
	class CustomButton extends HTMLElement {
		constructor() {
			super();
			const shadow = this.attachShadow({ mode: "closed" });
			const dom = document.querySelector("#test_template").content;
			shadow.append(dom);
		}
	}
	customElements.define("custom-button", CustomButton);
</script>
```

`this.attachShadow({ mode: "closed" })`çš„`closed`è¡¨ç¤ºè¡¨ç¤º `Shadow DOM` æ˜¯å°é—­çš„ï¼Œä¸å…è®¸å¤–éƒ¨è®¿é—®ã€‚å¦‚æœ`mode`çš„å€¼æ˜¯`open`ï¼Œåˆ™è¡¨ç¤ºå†…éƒ¨çš„èŠ‚ç‚¹å¯ä»¥è¢«å¤–éƒ¨è®¿é—®ï¼›

**æ·»åŠ æ ·å¼**

- å¦‚æœè‡ªå®šä¹‰å…ƒç´ éœ€è¦æ ·å¼ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å…¨å±€çš„æ ·å¼ï¼Œä¾‹å¦‚

```html
custom-button{ ... }
```

æ­£å¸¸æƒ…å†µæˆ‘ä»¬åº”è¯¥å°†æ ·å¼å’Œè‡ªå®šä¹‰æ ‡ç­¾å°è£…åœ¨ä¸€èµ·

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<div>222</div>
		<template id="test_template">
			<div class="container">
				<span class="test_custom">è‡ªæµ‹è‡ªå®šä¹‰æ ‡ç­¾</span>
				<slot name="userName"></slot>
			</div>
			<style>
				:host {
					position: relative;
					top: 10px;
				}
				.test_custom {
					color: red;
				}
				div {
					border: 1px solid black;
				}
			</style>
		</template>
		<custom-button>
			<span slot="userName">å¼ ä¸‰</span>
		</custom-button>
		<script>
			class CustomButton extends HTMLElement {
				constructor() {
					super();
					const shadow = this.attachShadow({ mode: "closed" });
					const dom = document.querySelector("#test_template").content;
					shadow.append(dom);
				}
			}
			customElements.define("custom-button", CustomButton);
		</script>
	</body>
</html>
```

`:host`ï¼šè¡¨ç¤ºå½“å‰çš„è‡ªå®šä¹‰å…ƒç´ èŠ‚ç‚¹;

å¦å¤–å¯ä»¥å‘ç°æˆ‘ä»¬å®šä¹‰çš„ div æ ·å¼åªä½œç”¨äºäº†`å½±å­dom`å†…éƒ¨å…ƒç´ ï¼Œå¯¹äºå¤–éƒ¨çš„ div æ²¡æœ‰ä»»ä½•å½±å“ï¼Œè¯æ˜äº†å½±å­ Dom çš„æ ·å¼`éš”ç¦»ç‰¹æ€§`ï¼›

## Custom Elementsï¼šè‡ªå®šä¹‰å…ƒç´ 

ä½¿ç”¨ `window.customElements.define` è‡ªå®šä¹‰ html æ ‡ç­¾å…ƒç´ ï¼Œè‡ªå®šä¹‰å…ƒç´ éœ€è¦æˆ‘ä»¬ç”¨ JS å°è£…ä¸€ä¸ªï¼Œæˆ‘ä»¬åœ¨ html å†…ä½¿ç”¨çš„è‡ªå®šä¹‰å…ƒç´ `custom-button`å°±æ˜¯è¯¥ç±»çš„å®ä¾‹ï¼›

è‡ªå®šä¹‰æ ‡ç­¾çš„ç”Ÿå‘½å‘¨æœŸ `constructor -> attributeChangedCallback -> connectedCallback`

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<custom-button></custom-button>
		<script>
			class CustomButton extends HTMLElement {
				constructor() {
					super();
					console.log("this", this);
					const info = document.createElement("span");
					info.setAttribute("class", "test_custom");
					info.textContent = "è‡ªæµ‹è‡ªå®šä¹‰æ ‡ç­¾";
					var container = document.createElement("div");
					container.classList.add("container");
					this.append(info, container);
				}
			}
			customElements.define("custom-button", CustomButton);
		</script>
	</body>
</html>
```

æµè§ˆå™¨æ‰“å¼€ï¼Œç„¶åè°ƒè¯•ï¼Œå†å…ƒç´ (Elemenets)æ ‡ç­¾ä¸Šçœ‹ï¼Œè‡ªå®šä¹‰æ ‡ç­¾çš„å­—æ®µ

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°`CustomButton`ç»§æ‰¿äº†`HTMLElement`ï¼Œä¹Ÿå°±æ˜¯ç»§æ‰¿äº† HTML å…ƒç´ çš„ç‰¹æ€§ï¼Œæœ€åæˆ‘ä»¬æ‰§è¡Œäº†`this.append(DOM)`ï¼Œä¹Ÿå°±æ˜¯å°†å…ƒç´ å†…å®¹æ·»åŠ åˆ°å½“å‰`è‡ªå®šä¹‰æ ‡ç­¾`å†…ï¼Œ`this`è¡¨ç¤ºè‡ªå®šä¹‰å…ƒç´ å®ä¾‹

åœ¨ custom element çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªä¸åŒçš„å›è°ƒå‡½æ•°ï¼Œå®ƒä»¬å°†ä¼šåœ¨å…ƒç´ çš„ä¸åŒç”Ÿå‘½æ—¶æœŸè¢«è°ƒç”¨ï¼š

- `connectedCallback`ï¼šå½“ custom element é¦–æ¬¡è¢«æ’å…¥æ–‡æ¡£ DOM æ—¶ï¼Œè¢«è°ƒç”¨ã€‚
- `disconnectedCallback`ï¼šå½“ custom element ä»æ–‡æ¡£ DOM ä¸­åˆ é™¤æ—¶ï¼Œè¢«è°ƒç”¨ã€‚
- `adoptedCallback`ï¼šå½“ custom element è¢«ç§»åŠ¨åˆ°æ–°çš„æ–‡æ¡£æ—¶ï¼Œè¢«è°ƒç”¨ã€‚
- `attributeChangedCallback`: å½“ custom element å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹è‡ªèº«å±æ€§æ—¶ï¼Œè¢«è°ƒç”¨ã€‚

```html

```

## åœ¨ vue react ä¸­ä½¿ç”¨ Web Components ç»„ä»¶

1ã€web ç»„ä»¶éƒ¨åˆ†ä»£ç ([git åœ°å€](https://github.com/ligaopeng123/Vue-WebComponents))

```js
(function () {
	// é…ç½®æ¨¡æ¿
	const getEemplate = () => {
		// åˆ›å»ºæ¨¡æ¿
		const template = document.createElement("template"); // ç»™æ¨¡æ¿è®¾ç½®id æ–¹ä¾¿æŸ¥æ‰¾
		template.id = "userCardTemplate";
		template.innerHTML = `
Â  Â  <style>
Â  Â  Â  Â  :host {
Â  Â  Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  Â  Â  width: 450px;
Â  Â  Â  Â  Â  Â  Â  Â  height: 180px;
Â  Â  Â  Â  Â  Â  Â  Â  background-color: #d4d4d4;
Â  Â  Â  Â  Â  Â  Â  Â  border: 1px solid #d5d5d5;
Â  Â  Â  Â  Â  Â  Â  Â  box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 3px;
Â  Â  Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  .image {
Â  Â  Â  Â  Â  Â  Â  Â  flex: 0 0 auto;
Â  Â  Â  Â  Â  Â  Â  Â  width: 160px;
Â  Â  Â  Â  Â  Â  Â  Â  height: 160px;
Â  Â  Â  Â  Â  Â  Â  Â  vertical-align: middle;
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  Â  Â  height: 160px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  .container > .name {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  Â  Â  line-height: 1;
Â  Â  Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  .container > .email {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0.75;
Â  Â  Â  Â  Â  Â  Â  Â  line-height: 1;
Â  Â  Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  .container > .button {
Â  Â  Â  Â  Â  Â  Â  Â  padding: 10px 25px;
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â </style>
Â  Â  <img class="image">
Â  Â  <div class="container">
Â  Â  Â  Â  <p class="name"></p>
Â  Â  Â  Â  <p class="email"></p>
Â  Â  Â  Â  <button class="button">Follow John</button>
Â  Â  </div>
Â  Â  `;
		return template;
	}; // è®²æ¨¡æ¿æ”¾åˆ°domç»“æ„ä¸­å»
	const createEemplate = () => {
		document.body.appendChild(getEemplate());
	};
	createEemplate();
	class UserCard extends HTMLElement {
		constructor() {
			super();
			this.creatShadow(); // æ­¤å¤„é˜²æ­¢vueç­‰æ¡†æ¶ç±»å‹çš„ç»„ä»¶ä½¿ç”¨æ—¶ ç”Ÿå‘½å‘¨æœŸå¯¼è‡´çš„å‚æ•°å¼‚å¸¸ å› æ­¤å»¶è¿Ÿç»‘å®šå‚æ•°
			setTimeout(() => {
				this.creatContent();
			});
		}
		/**
		 * å°é—­å†…éƒ¨dom
		 */
		creatShadow() {
			this.shadow = this.attachShadow({ mode: "closed" });
		}
		/**
		 * åˆ›å»ºå†…éƒ¨æ˜¾ç¤ºå†…å®¹
		 */
		creatContent() {
			var templateElem = document.getElementById("userCardTemplate");
			var content = templateElem.content.cloneNode(true);
			content
				.querySelector("img")
				.setAttribute("src", this.getAttribute("image"));
			content.querySelector(".container>.name").innerText =
				this.getAttribute("name");
			content.querySelector(".container>.email").innerText =
				this.getAttribute("email");
			this.shadow.appendChild(content);
		}
		/**
		 * å½“è‡ªå®šä¹‰å…ƒç´ ç¬¬ä¸€æ¬¡è¢«è¿æ¥åˆ°æ–‡æ¡£DOMæ—¶è¢«è°ƒç”¨
		 * ç›¸å½“äºmounted
		 */
		connectedCallback() {
			console.log("connectedCallback");
		}
		/**
		 * å½“è‡ªå®šä¹‰å…ƒç´ ä¸æ–‡æ¡£DOMæ–­å¼€è¿æ¥æ—¶è¢«è°ƒç”¨ã€‚
		 * ä¸beforeDestroyç±»ä¼¼
		 */
		disconnectedCallback() {
			console.log("disconnectedCallback");
		}
		/**
		 * å½“è‡ªå®šä¹‰å…ƒç´ è¢«ç§»åŠ¨åˆ°æ–°æ–‡æ¡£æ—¶è¢«è°ƒç”¨ã€‚
		 */
		adoptedCallback() {
			console.log("adoptedCallback");
		}
		/**
		 * æš´éœ²å“ªäº›å±æ€§å¯ä»¥è¢«ç›‘å¬
		 * @returns {string[]}
		 */
		static get observedAttributes() {
			return ["image", "name", "email"];
		}
		/**
		 * å½“è‡ªå®šä¹‰å…ƒç´ çš„ä¸€ä¸ªå±æ€§è¢«å¢åŠ ã€ç§»é™¤æˆ–æ›´æ”¹æ—¶è¢«è°ƒç”¨ã€‚
		 */
		attributeChangedCallback() {
			console.log("attributeChangedCallback");
		}
	}
	window.customElements.define("user-card", UserCard);
})();
/**
 * è‡ªå®šä¹‰äº‹ä»¶
 */
this.dispatchEvent(
	new CustomEvent("submit", {
		detail: {
			data: {},
		},
	})
);
this.dispatchEvent(
	new CustomEvent("afterSubmit", {
		detail: {
			data: {},
		},
	})
);
```

2ã€vue ä¸­ä½¿ç”¨éƒ¨é—¨ä»£ç 

åœ¨ public ç›®å½•ä¸‹å¾— index.html ä¸­å¯¼å…¥

```html
<script src="./UserCard.js"></script>
<template>
	Â 
	<div id="app">
		Â  Â 
		<user-card
			v-if="show"
			image="https://semantic-ui.com/images/avatar2/large/kristy.png"
			name="User Name"
			email="yourmail@some-email.com"
		></user-card>
		Â  Â  Â 
		<user-card
			image="https://semantic-ui.com/images/avatar2/large/kristy.png"
			name="test"
			email="yourmail@some-email.com"
		></user-card>
		Â  Â  <button @click="onclick">Â  Â  Â  æµ‹è¯• Â  Â </button> Â 
	</div>
</template>
<script>
	export default {
		data: function () {
			return {
				show: true,
			};
		},
		name: "App",
		mounted() {},
		methods: {
			// æµ‹è¯•webç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
			onclick() {
				this.show = !this.show;
			},
		},
	};
</script>
<style>
	#app {
	Â  font-family: Avenir, Helvetica, Arial, sans-serif;
	Â  -webkit-font-smoothing: antialiased;
	Â  -moz-osx-font-smoothing: grayscale;
	Â  text-align: center;
	Â  color: #2c3e50;
	Â  margin-top: 60px;
	}
</style>
```

3ã€åœ¨ react ä¸­ä½¿ç”¨

```jsx
// submitäº‹ä»¶ åœ¨ç‚¹å‡»ç™»å½•æ—¶è§¦å‘ï¼Œä¼ é€’çš„ç™»å½•ä¿¡æ¯åœ¨ï¼Œdetailå­—æ®µä¸­
// afterSubmit åœ¨ç™»å½•æ•°æ®ä¸‹å‘æœåŠ¡ç«¯åè§¦å‘ ç”¨äºå¤„ç†ç™»å½•åçš„è·¯ç”±è·³è½¬ç­‰é€»è¾‘
<user-card url="https://www.baidu.com/"
Â  Â  Â  Â  Â  Â  Â  Â  Â  user="account"
Â  Â  Â  Â  Â  Â  Â  Â  Â  password="password"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="form"
Â  Â  Â  Â  Â  Â  Â  Â  Â  style="background-image: url(/assets/background.jpg)"
Â  Â  Â  Â  Â  Â  Â  Â  Â  body-style="right: 200px;"
Â  Â  Â  Â  Â  Â  Â  Â  Â  title="ç³»ç»Ÿ">
Â  Â  </user-card>
Â  Â  <script>
Â  Â  Â  Â  const form = document.querySelector('#form');
Â  Â  Â  Â  form.addEventListener('submit', (data)=> {
Â  Â  Â  Â  Â Â  Â console.log(data)
Â  Â  Â  Â  });
Â  Â  Â  Â  form.addEventListener('afterSubmit', (data)=> {
Â Â  Â  Â  Â  Â  Â console.log(data)
Â  Â  Â  Â  });
Â  Â  </script>

/**
Â * å¤„ç†react tsxä¸­ç›´æ¥ä½¿ç”¨web componentsæŠ¥é”™é—®é¢˜
Â */
interface UserCardModuleProps extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement> {
Â Â  Â title: string,
Â Â  Â ...
}
declare global {
Â Â  Â namespace JSX {
Â Â  Â Â Â  Â interface IntrinsicElements {
Â Â  Â Â Â  Â Â Â  Â 'user-card': UserCardModuleProps
Â Â  Â Â Â  Â }
Â Â  Â }
}
```

4ã€åœ¨ html ä¸­ä½¿ç”¨

```html
<!DOCTYPE html>
<html>
	<head>
		Â  Â 
		<meta charset="utf-8" />
		Â  Â 
		<meta name="viewport" content="width=device-width" />
		Â  Â 
		<title>JS Bin</title>
	</head>
	<body>
		<user-card
			image="https://semantic-ui.com/images/avatar2/large/kristy.png"
			name="User Name"
			email="yourmail@some-email.com"
		></user-card>
		<user-card
			image="https://semantic-ui.com/images/avatar2/large/kristy.png"
			name="test"
			email="yourmail@some-email.com"
		></user-card>
		<script src="./public/UserCard.js"></script>
		<script></script>
	</body>
</html>
```

## å…¶ä»–

åŸºäº Web Components å®ç°ä¸€ä¸ªæ—¥å†åŸç”Ÿç»„ä»¶ï¼šhttps://www.jb51.net/javascript/292802p6p.htm

[svelte + vite å¼€å‘ Web Components - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7215896450608300087)

### ç¼–å†™ Web Components ç»„ä»¶

https://blog.51cto.com/palxp/5776126

```html
<!-- ç»„ä»¶ä½¿ç”¨ -->
<warning-card title="å‰æ–¹é«˜èƒ½">
	<img
		slot="desc"
		src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba825ffee78c4a1b9c0232e5d2f1d048~tplv-k3u1fbpfcp-watermark.image?"
	/>
</warning-card>

<!-- ç»„ä»¶å®šä¹‰ -->
<template id="warning-card">
	<details class="ContentWarning">
		<summary><strong>âš ï¸ æ³¨æ„:</strong> <span id="title"></span></summary>
		<slot name="desc">THE DESCRIPTION</slot>
	</details>
	<!-- ç»„ä»¶æ ·å¼ -->
	<style>
		.ContentWarning {
			border: 1px solid rgb(0 0 0 / 0.3);
			border-radius: 0.2em;
			padding: 1em;
		}

		.ContentWarning > summary {
			position: relative;
			transition: all 0.3s;
			list-style: none;
			user-select: none;
			cursor: pointer;
			padding: 1em;
			margin: -1em;
			--stripe-color: rgb(0 0 0 / 0.1);
			background-image: repeating-linear-gradient(
				45deg,
				transparent,
				transparent 0.5em,
				var(--stripe-color) 0.5em,
				var(--stripe-color) 1em
			);
		}

		.ContentWarning > summary::after {
			content: "â†• å±•å¼€æŸ¥çœ‹";
			text-transform: uppercase;
			letter-spacing: 1px;
			opacity: 0.8;
			font-size: 70%;
			position: absolute;
			right: 1em;
			top: 50%;
			transform: translatey(-50%);
		}

		.ContentWarning[open] > summary {
			margin-bottom: 1em;
		}

		.ContentWarning > summary:hover,
		.ContentWarning > summary:focus {
			--stripe-color: rgb(150 0 0 / 0.1);
		}
	</style>
</template>

<style>
	body {
		font: 125% / 1.4 sans-serif;
		max-width: 600px;
		margin: 1em auto;
		padding: 1em;
	}

	img {
		max-width: 100%;
		display: block;
		height: auto;
	}
</style>

<script>
	// class WarningCard extends HTMLElement {
	//   constructor() {
	//     super();
	//     var templateElem = document.getElementById('warning-card');
	//     var content = templateElem.content.cloneNode(true);
	//     this.appendChild(content);
	//   }
	// }
	// customElements.define('warning-card', WarningCard);

	window.customElements.define(
		"warning-card",
		class extends HTMLElement {
			constructor() {
				super();
				// var templateElem = document.getElementById('warning-card');
				// var content = templateElem.content.cloneNode(true);
				// this.appendChild(content);

				var template = document.getElementById("warning-card").content;
				template.querySelector("#title").innerText = this.getAttribute("title");
				this.attachShadow({ mode: "open" }).appendChild(
					template.cloneNode(true)
				);
			}
		}
	);
</script>
```

## :alarm_clock:åŸºäº web Components çš„æ¡†æ¶

### LitElement

LitElement æ˜¯ä¸€æ¬¾ç”± Google å›¢é˜Ÿå¼€å‘çš„åŸºäº Web Component æ ‡å‡†çš„è½»é‡çº§ã€å¯å¤ç”¨çš„ Web ç»„ä»¶åº“ï¼Œè¿˜æ‹¥æœ‰å“åº”å¼æ•°æ®ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­‰åŠŸèƒ½ã€‚å®ƒä½¿ç”¨äº†åŸç”Ÿçš„ Web å¹³å°åŠŸèƒ½ï¼Œä¸éœ€è¦ä¾èµ–å…¶ä»–æ¡†æ¶æˆ–è¿è¡Œæ—¶ã€‚é€‚ç”¨äºå•ä¸ªç»„ä»¶å’Œç»„ä»¶åº“å¼€å‘ï¼Œå¹¶è§£å†³äº† webComponent çš„ Custom Elements çš„å…¼å®¹æ€§é—®é¢˜ã€‚

- æ–°ç‰ˆå­˜å‚¨åº“ï¼šhttps://github.com/lit/lit/
- æ—§ç‰ˆå­˜å‚¨åº“ï¼šhttps://github.com/lit/lit-element
- å®˜ç½‘ï¼šhttps://lit.dev/

### ofajs

å®˜ç½‘ï¼š[ofa.js - ä¸éœ€è¦æ‰“åŒ…çš„ MVVM JavaScript æ¡†æ¶ (ofajs.com)](https://ofajs.com/cn/index.html)

å¼€æºåœ°å€ï¼šhttps://github.com/kirakiray/ofa.js

### shoelace

å¼€æºåœ°å€ï¼š[shoelace-style/shoelaceï¼šåŸºäº Web æ ‡å‡†æ„å»ºçš„ä¸“ä¸šè®¾è®¡çš„æ—¥å¸¸ UI ç»„ä»¶çš„é›†åˆã€‚é€‚ç”¨äºæ‰€æœ‰æ¡†æ¶ä»¥åŠå¸¸è§„ HTML/CSS/JSã€‚ğŸ¥¾ (github.com)](https://github.com/shoelace-style/shoelace)

å®˜ç½‘ï¼š[Shoelaceï¼šä¸€ä¸ªå…·æœ‰å‰ç»æ€§çš„ Web ç»„ä»¶åº“ã€‚](https://shoelace.style/)

### OhMyLive2D

é«˜å¯è‡ªå®šä¹‰ä¸”å¼€ç®±å³ç”¨çš„ Live2D For Web ç»„ä»¶, å¿«é€Ÿä¸ºæ‚¨çš„ä¸ªäººç½‘ç«™åŠ å…¥Live2Dçœ‹æ¿å¨˜

å®˜ç½‘ï¼š[OhMyLive2D (oml2d.com)](https://oml2d.com/)

å¼€æºåœ°å€ï¼š[oh-my-live2d/oh-my-live2d: åº”ç”¨äºæµè§ˆå™¨ç¯å¢ƒä¸”å¼€ç®±å³ç”¨çš„Live2Dç»„ä»¶, å®ƒæ”¯æŒæ‰€æœ‰ç‰ˆæœ¬çš„Live2Dæ¨¡å‹, ä½¿ç”¨æ–¹å¼è¶³å¤Ÿç®€å•å¹¶ä¸”é«˜å¯è‡ªå®šä¹‰, å¯ä»¥å¿«é€Ÿä¸ºæ‚¨çš„ä¸ªäººç½‘ç«™æ·»åŠ Live2Dçœ‹æ¿å¨˜, ä½¿æ‚¨çš„ä¸ªäººç½‘ç«™å˜å¾—æ›´å…·æœ‰ç‰¹è‰². (github.com)](https://github.com/oh-my-live2d/oh-my-live2d)

### cami.js

[kennyfrc/cami.jsï¼šCami.js æ˜¯ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„å·¥å…·åŒ…ï¼Œç”¨äº Web åº”ç”¨ç¨‹åºä¸­çš„äº¤äº’å¼å­¤å²›ã€‚æ— éœ€æ„å»ºæ­¥éª¤ã€‚ (github.com)](https://github.com/kennyfrc/cami.js)
