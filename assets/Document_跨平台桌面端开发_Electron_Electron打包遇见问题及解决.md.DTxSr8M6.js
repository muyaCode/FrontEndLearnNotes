import{_ as n,c as e,o as a,ah as r}from"./chunks/framework.DqD713j2.js";const d=JSON.parse('{"title":"Electron打包遇见问题及解决","description":"","frontmatter":{},"headers":[],"relativePath":"Document/跨平台桌面端开发/Electron/Electron打包遇见问题及解决.md","filePath":"Document/跨平台桌面端开发/Electron/Electron打包遇见问题及解决.md","lastUpdated":1750954157000}'),l={name:"Document/跨平台桌面端开发/Electron/Electron打包遇见问题及解决.md"};function o(p,s,t,i,c,b){return a(),e("div",null,s[0]||(s[0]=[r(`<h1 id="electron打包遇见问题及解决" tabindex="-1">Electron打包遇见问题及解决 <a class="header-anchor" href="#electron打包遇见问题及解决" aria-label="Permalink to &quot;Electron打包遇见问题及解决&quot;">​</a></h1><h2 id="✨electron-builder-库-打包问题解决" tabindex="-1">✨Electron-builder 库 打包问题解决 <a class="header-anchor" href="#✨electron-builder-库-打包问题解决" aria-label="Permalink to &quot;✨Electron-builder 库 打包问题解决&quot;">​</a></h2><p><code>NPM</code>下载的问题</p><p>因为<code>NPM</code>在国内比较慢。导致<code>electron-V.xxxx.zip</code>下载失败。这些东西如果是第一次打包的话是需要下载对应<code>electron</code>打包依赖的包版本的支持文件。</p><p>electron-build配置详情：<a href="https://www.electron.build/configuration/configuration" target="_blank" rel="noreferrer">https://www.electron.build/configuration/configuration</a></p><p>electron打包淘宝镜像：<a href="https://registry.npmmirror.com/binary.html?path=electron/" target="_blank" rel="noreferrer">https://registry.npmmirror.com/binary.html?path=electron/</a></p><p>electron-builder-binaries打包淘宝镜像：<a href="https://registry.npmmirror.com/binary.html?path=electron-builder-binaries/" target="_blank" rel="noreferrer">https://registry.npmmirror.com/binary.html?path=electron-builder-binaries/</a></p><h3 id="下列离线下载的安装存放路径" tabindex="-1">下列离线下载的安装存放路径 <a class="header-anchor" href="#下列离线下载的安装存放路径" aria-label="Permalink to &quot;下列离线下载的安装存放路径&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">electron-v.xxxx.zip文件：</span></span>
<span class="line"><span style="color:#61AFEF;">windows系统路径：C:\\Users\\用户名的文件夹\\AppData\\Local\\electron\\Cache</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;">或者</span><span style="color:#98C379;">  %LOCALAPPDATA%</span><span style="color:#56B6C2;">\\e</span><span style="color:#98C379;">lectron</span><span style="color:#56B6C2;">\\c</span><span style="color:#98C379;">ache</span></span>
<span class="line"><span style="color:#61AFEF;">Linux系统路径：/.cache/electron</span></span>
<span class="line"><span style="color:#61AFEF;">macOS系统路径：/Library/Caches/electron</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">nsis-v.xxx.7z、nsis-resources-v.xxx.7z、winCodeSign-v.xxx.7z文件：</span></span>
<span class="line"><span style="color:#61AFEF;">上面相同地址前缀/electron-builder</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr><h3 id="_1-离线下载electron-builder-打包的依赖包" tabindex="-1">1.离线下载Electron-builder 打包的依赖包 <a class="header-anchor" href="#_1-离线下载electron-builder-打包的依赖包" aria-label="Permalink to &quot;1.离线下载Electron-builder 打包的依赖包&quot;">​</a></h3><h4 id="_1-打包时下载electron-v-xxxx-zip文件失败" tabindex="-1">(1.打包时下载electron-v.xxxx.zip文件失败 <a class="header-anchor" href="#_1-打包时下载electron-v-xxxx-zip文件失败" aria-label="Permalink to &quot;(1.打包时下载electron-v.xxxx.zip文件失败&quot;">​</a></h4><blockquote><p>electron打包淘宝镜像：<a href="https://registry.npmmirror.com/binary.html?path=electron/" target="_blank" rel="noreferrer">https://registry.npmmirror.com/binary.html?path=electron/</a></p></blockquote><p>win解决办法：直接在electron打包淘宝镜像下载对应版本和打包平台的文件</p><p>windows系统下载完解压放到：C:\\Users\\系统用户名\\AppData\\Local\\electron\\Cache</p><p>Electron设置淘宝源</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#98C379;"> config</span><span style="color:#98C379;"> set</span><span style="color:#98C379;"> registry</span><span style="color:#98C379;"> https://registry.npm.taobao.org/</span></span>
<span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#98C379;"> config</span><span style="color:#98C379;"> set</span><span style="color:#98C379;"> ELECTRON_MIRROR</span><span style="color:#98C379;"> http://npm.taobao.org/mirrors/electron/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>🍊其他系统平台的存放路径看：下列离线下载的安装存放路径</strong>：</p><h4 id="_2-打包时下载-wincodesign-v-xxx-7z文件-、nsis-resources-v-xxx-7z文件、nsis-v-xxx-7z文件-失败" tabindex="-1">(2.打包时下载 winCodeSign-v.xxx.7z文件 、nsis-resources-v.xxx.7z文件、nsis-v.xxx.7z文件 失败 <a class="header-anchor" href="#_2-打包时下载-wincodesign-v-xxx-7z文件-、nsis-resources-v-xxx-7z文件、nsis-v-xxx-7z文件-失败" aria-label="Permalink to &quot;(2.打包时下载 winCodeSign-v.xxx.7z文件 、nsis-resources-v.xxx.7z文件、nsis-v.xxx.7z文件  失败&quot;">​</a></h4><blockquote><p>electron-builder-binaries 包 github下载：<a href="https://github.com/electron-userland/electron-builder-binaries/releases" target="_blank" rel="noreferrer">https://github.com/electron-userland/electron-builder-binaries/releases</a></p><p>electron-builder-binaries的淘宝镜像：<a href="https://registry.npmmirror.com/binary.html?path=electron/" target="_blank" rel="noreferrer">https://registry.npmmirror.com/binary.html?path=electron/</a></p></blockquote><p><strong>winCodeSign-v.xxx.7z下载地址</strong>：<a href="https://github.com/electron-userland/electron-builder-binaries/releases/download/winCodeSign-2.5.0/winCodeSign-2.5.0.7z" target="_blank" rel="noreferrer">https://github.com/electron-userland/electron-builder-binaries/releases/download/winCodeSign-2.5.0/winCodeSign-2.5.0.7z</a></p><p><strong>nsis-resources-v.xxx.7z下载地址</strong>：<a href="https://github.com/electron-userland/electron-builder-binaries/releases/download/nsis-3.0.4.1/nsis-3.0.4.1.7z" target="_blank" rel="noreferrer">https://github.com/electron-userland/electron-builder-binaries/releases/download/nsis-3.0.4.1/nsis-3.0.4.1.7z</a></p><p><strong>nsis-v.xxx.7z文件下载地址</strong>：<a href="https://github.com/electron-userland/electron-builder-binaries/releases/download/nsis-resources-3.4.1/nsis-resources-3.4.1.7z" target="_blank" rel="noreferrer">https://github.com/electron-userland/electron-builder-binaries/releases/download/nsis-resources-3.4.1/nsis-resources-3.4.1.7z</a></p><p>windows系统下载完解压放到：</p><ol><li><p><strong>winCodeSign-v.xxx.7z</strong>：C:\\Users\\用户名\\AppData\\Local\\electron-builder\\Cache\\winCodeSign</p></li><li><p><strong>两个nsis压缩文件</strong>：C:\\Users\\用户名\\AppData\\Local\\electron-builder\\Cache\\nsis</p></li></ol><p><strong>🍊其他系统平台的存放路径看：下列离线下载的安装存放路径</strong>：</p><h3 id="_2-在项目根目录中使用-npmrc-或者-yarnrc-镜像指定来下载相关包" tabindex="-1">2.在项目根目录中使用 .npmrc 或者 .yarnrc 镜像指定来下载相关包 <a class="header-anchor" href="#_2-在项目根目录中使用-npmrc-或者-yarnrc-镜像指定来下载相关包" aria-label="Permalink to &quot;2.在项目根目录中使用 .npmrc 或者 .yarnrc 镜像指定来下载相关包&quot;">​</a></h3><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"># registry </span><span style="color:#98C379;">&quot;https://registry.npm.taobao.org/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"># electron_mirror </span><span style="color:#98C379;">&quot;https://registry.npmmirror.com/binary.html?path=electron/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;"># electron_builder_binaries_mirror </span><span style="color:#98C379;">&quot;https://registry.npmmirror.com/binary.html?path=electron-builder-binaries/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"># sass_binary_site </span><span style="color:#98C379;">&quot;https://registry.npmmirror.com/binary.html?path=node-sass/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;"># # phantomjs_cdnurl </span><span style="color:#98C379;">&quot;http://cnpmjs.org/downloads&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"># # sqlite</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">_binary_host_mirror </span><span style="color:#98C379;">&quot;https://foxgis.oss-cn-shanghai.aliyuncs.com/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;"># profiler_binary_host_mirror </span><span style="color:#98C379;">&quot;https://registry.npmmirror.com/binary.html?path=node-inspector/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;"># chromedriver_cdnurl </span><span style="color:#98C379;">&quot;https://cdn.npm.taobao.org/dist/chromedriver&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">registry </span><span style="color:#98C379;">&quot;https://registry.npm.taobao.org/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">electron_mirror </span><span style="color:#98C379;">&quot;https://npm.taobao.org/mirrors/electron/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">electron_builder_binaries_mirror </span><span style="color:#98C379;">&quot;http://npm.taobao.org/mirrors/electron-builder-binaries/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">sass_binary_site </span><span style="color:#98C379;">&quot;https://npm.taobao.org/mirrors/node-sass/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">phantomjs_cdnurl </span><span style="color:#98C379;">&quot;http://cnpmjs.org/downloads&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">sqlite</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">_binary_host_mirror </span><span style="color:#98C379;">&quot;https://foxgis.oss-cn-shanghai.aliyuncs.com/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">profiler_binary_host_mirror </span><span style="color:#98C379;">&quot;https://npm.taobao.org/mirrors/node-inspector/&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">chromedriver_cdnurl </span><span style="color:#98C379;">&quot;https://cdn.npm.taobao.org/dist/chromedriver&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><hr><h2 id="✨-electron-forge-cli-库-打包问题解决" tabindex="-1">✨@electron-forge/cli 库 打包问题解决 <a class="header-anchor" href="#✨-electron-forge-cli-库-打包问题解决" aria-label="Permalink to &quot;✨@electron-forge/cli 库 打包问题解决&quot;">​</a></h2><hr><h2 id="✨electron打包-与vue3-vite-typescript-vite-plugin-electron结合-的问题" tabindex="-1">✨electron打包 与vue3 + vite + TypeScript + vite-plugin-electron结合 的问题 <a class="header-anchor" href="#✨electron打包-与vue3-vite-typescript-vite-plugin-electron结合-的问题" aria-label="Permalink to &quot;✨electron打包 与vue3 + vite + TypeScript + vite-plugin-electron结合 的问题&quot;">​</a></h2><h3 id="_1-使用路由懒加载-打包后报错-require-is-not-defined" tabindex="-1">1.使用路由懒加载，打包后报错：<code>require is not defined</code> <a class="header-anchor" href="#_1-使用路由懒加载-打包后报错-require-is-not-defined" aria-label="Permalink to &quot;1.使用路由懒加载，打包后报错：\`require is not defined\`&quot;">​</a></h3><blockquote><p>如果vue-router使用了路由懒加载，electron 打包后会报错（ReferenceError: require is not defined）：vite-plugin-electron 默认使用 cjs 打包，要改成es打包才不会报错</p></blockquote><p>vite.config.ts的defineConfig中添加配置：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">build: {</span></span>
<span class="line"><span style="color:#FFFFFF;">  rollupOptions</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#FFFFFF;">    output</span><span style="color:#ABB2BF;">: { </span></span>
<span class="line"><span style="color:#FFFFFF;">      format</span><span style="color:#ABB2BF;">: </span><span style="color:#FFFFFF;">&#39;es&#39;</span><span style="color:#7F848E;font-style:italic;"> // 如果vue-router使用了路由懒加载，electron 打包后会报错（ReferenceError: require is not defined）：vite-plugin-electron 默认使用 cjs 打包，要改成es打包才不会报错</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-运行白屏-控制台报错资源无法加载" tabindex="-1">2.运行白屏，控制台报错资源无法加载 <a class="header-anchor" href="#_2-运行白屏-控制台报错资源无法加载" aria-label="Permalink to &quot;2.运行白屏，控制台报错资源无法加载&quot;">​</a></h3><p>运行出来会发现是白屏，打开程序控制台可以看到是js文件找不到。 打开dist中index.html发现是js和css路径都是绝对路径，所以这里需要修改为相对路径。</p><p>打开 vite.config.js 配置更路径为相对路径</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#61AFEF;"> defineConfig</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">  plugins</span><span style="color:#ABB2BF;">: [</span><span style="color:#61AFEF;">vue</span><span style="color:#ABB2BF;">()],</span></span>
<span class="line"><span style="color:#E06C75;">  base</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;./&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 更路径为相对路径</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,40)]))}const m=n(l,[["render",o]]);export{d as __pageData,m as default};
