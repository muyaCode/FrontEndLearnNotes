import{_ as n,c as a,o as l,ah as p}from"./chunks/framework.DqD713j2.js";const e="/FrontEndLearnNotes/assets/1585470698327.ChzcQfRF.png",o="/FrontEndLearnNotes/assets/1585470708367.yeESglPY.png",r="/FrontEndLearnNotes/assets/1585472204585.BSpxw8_y.png",t="/FrontEndLearnNotes/assets/1585472467480.fFgu27nq.png",c="/FrontEndLearnNotes/assets/1585472901948.BqefgSl7.png",i="/FrontEndLearnNotes/assets/1585473992676.C6omukdY.png",b="/FrontEndLearnNotes/assets/1585474123142.CxK2i00X.png",u="/FrontEndLearnNotes/assets/1585474285569.77gHlAip.png",d="/FrontEndLearnNotes/assets/1585474498560.eQG17agF.png",m="/FrontEndLearnNotes/assets/1585474692372.C3buabWp.png",y="/FrontEndLearnNotes/assets/1585475724394.DXi4CG9y.png",F="/FrontEndLearnNotes/assets/1585476182255.D7kCF-xK.png",g="/FrontEndLearnNotes/assets/1585476235731.CcQmjhhq.png",h="/FrontEndLearnNotes/assets/1585476311406.CC045Hmn.png",A="/FrontEndLearnNotes/assets/1585476428632.CdgEF4pG.png",B="/FrontEndLearnNotes/assets/1585476535470.BmjH8dtE.png",q="/FrontEndLearnNotes/assets/1585476576207.CfHwYUhd.png",E="/FrontEndLearnNotes/assets/1585476763631.Bg_q29II.png",C="/FrontEndLearnNotes/assets/1585461681918.BpnaeMw_.png",k="/FrontEndLearnNotes/assets/1585477310460.gGCi_5Qx.png",_="/FrontEndLearnNotes/assets/1585477412871.BG7njTWY.png",v="/FrontEndLearnNotes/assets/1585478949532.Bss93ifl.png",x="/FrontEndLearnNotes/assets/1585479066717.CW0i-Hgk.png",D="/FrontEndLearnNotes/assets/1585479128562.DxJtwHO-.png",f="/FrontEndLearnNotes/assets/1585479276933.CYfqU_MF.png",N="/FrontEndLearnNotes/assets/1585479291125.BVc3w7ov.png",L="/FrontEndLearnNotes/assets/1585479528999.p9JZy-8a.png",P="/FrontEndLearnNotes/assets/1585479805712.DyKkdEv_.png",w="/FrontEndLearnNotes/assets/1585479857883.Do1B3KyG.png",M="/FrontEndLearnNotes/assets/1585480505097.1EjnXoBX.png",$="/FrontEndLearnNotes/assets/1585480639789.C6JXrPOQ.png",I="/FrontEndLearnNotes/assets/1585480881340.CQv3R6E4.png",S="/FrontEndLearnNotes/assets/1585480948534.N0fe6WmN.png",W="/FrontEndLearnNotes/assets/1585480971194.C2H7T73W.png",T="/FrontEndLearnNotes/assets/1585480981182.DIKDobJw.png",H="/FrontEndLearnNotes/assets/1585481050097.JjQz1snE.png",O="/FrontEndLearnNotes/assets/1585481783387.BIX0sVir.png",Y=JSON.parse('{"title":"MongoDB 高级","description":"","frontmatter":{},"headers":[],"relativePath":"Document/数据库的使用/MongoDB数据库/MongoDB高级.md","filePath":"Document/数据库的使用/MongoDB数据库/MongoDB高级.md","lastUpdated":1750954157000}'),Q={name:"Document/数据库的使用/MongoDB数据库/MongoDB高级.md"};function U(J,s,X,G,j,K){return l(),a("div",null,s[0]||(s[0]=[p('<h1 id="mongodb-高级" tabindex="-1">MongoDB 高级 <a class="header-anchor" href="#mongodb-高级" aria-label="Permalink to &quot;MongoDB 高级&quot;">​</a></h1><p>官方文档首页：<a href="https://www.mongodb.com/docs/" target="_blank" rel="noreferrer">MongoDB 文档</a></p><p>MongoDB 高级文档：<a href="https://www.mongodb.com/docs/manual/tutorial/getting-started/" target="_blank" rel="noreferrer">入门 — MongoDB 手册</a></p><h2 id="■mongodb-排序-分页" tabindex="-1">■MongoDB 排序&amp;分页 <a class="header-anchor" href="#■mongodb-排序-分页" aria-label="Permalink to &quot;■MongoDB 排序&amp;分页&quot;">​</a></h2><h3 id="明确需求" tabindex="-1">明确需求 <a class="header-anchor" href="#明确需求" aria-label="Permalink to &quot;明确需求&quot;">​</a></h3><p>数据库，是用来存放数据的</p><p>咱们后期从数据库获取数据 需要排序 、多页展示如何实现？</p><p><img src="'+e+'" alt="1585470698327"></p><p><img src="'+o+`" alt="1585470708367"></p><h3 id="准备" tabindex="-1">准备 <a class="header-anchor" href="#准备" aria-label="Permalink to &quot;准备&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> test3</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:1,name:</span><span style="color:#61AFEF;">&quot;a&quot;</span><span style="color:#61AFEF;">,sex:1,age:1}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:2,name:</span><span style="color:#61AFEF;">&quot;a&quot;</span><span style="color:#61AFEF;">,sex:1,age:2}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:3,name:</span><span style="color:#61AFEF;">&quot;b&quot;</span><span style="color:#61AFEF;">,sex:2,age:3}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:4,name:</span><span style="color:#61AFEF;">&quot;c&quot;</span><span style="color:#61AFEF;">,sex:2,age:4}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:5,name:</span><span style="color:#61AFEF;">&quot;d&quot;</span><span style="color:#61AFEF;">,sex:2,age:5}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">db.c1.find</span><span style="color:#ABB2BF;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="排序" tabindex="-1">排序 <a class="header-anchor" href="#排序" aria-label="Permalink to &quot;排序&quot;">​</a></h3><ul><li><p>语法：db.集合名.find().sort(JSON 数据)</p></li><li><p>说明：键-就是要排序的列/字段、值：1 升序 -1 降序</p></li><li><p>练习：年龄升序&amp;降序</p></li></ul><blockquote><p><img src="`+r+'" alt="1585472204585"></p></blockquote><h3 id="limit-与-skip-方法" tabindex="-1">Limit 与 Skip 方法 <a class="header-anchor" href="#limit-与-skip-方法" aria-label="Permalink to &quot;Limit 与 Skip 方法&quot;">​</a></h3><ul><li>语法：db.集合名.find().sort().skip(数字).limit(数字)</li><li>说明：skip 跳过指定数量（可选），limit 限制查询的数量</li><li>练习：1-降序查询查询 2 条，2-降序跳过 2 条并查询 2 条</li></ul><blockquote><p><img src="'+t+`" alt="1585472467480"></p></blockquote><h3 id="实战分页" tabindex="-1">实战分页 <a class="header-anchor" href="#实战分页" aria-label="Permalink to &quot;实战分页&quot;">​</a></h3><p>需求：数据库 1 - 10 数据，每页显示两条（5 页）</p><p>语法：db.集合名.find().skip().limit(2)</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">skip计算公式：（当前页</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 1）</span><span style="color:#E5C07B;"> *</span><span style="color:#98C379;"> 每页显示条数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">1页</span><span style="color:#D19A66;">    1</span><span style="color:#D19A66;">  2</span><span style="color:#D19A66;">        0</span></span>
<span class="line"><span style="color:#61AFEF;">2页</span><span style="color:#D19A66;">    3</span><span style="color:#D19A66;">  4</span><span style="color:#D19A66;">        2</span></span>
<span class="line"><span style="color:#61AFEF;">3页</span><span style="color:#D19A66;">    5</span><span style="color:#D19A66;">  6</span><span style="color:#D19A66;">        4</span></span>
<span class="line"><span style="color:#61AFEF;">4页</span><span style="color:#D19A66;">    7</span><span style="color:#D19A66;">  8</span><span style="color:#D19A66;">        6</span></span>
<span class="line"><span style="color:#61AFEF;">5页</span><span style="color:#D19A66;">    9</span><span style="color:#D19A66;">  10</span><span style="color:#D19A66;">        8</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="小总结" tabindex="-1">小总结 <a class="header-anchor" href="#小总结" aria-label="Permalink to &quot;小总结&quot;">​</a></h3><p>db.集合名.find()</p><p>.sort({列: 1/-1})排序</p><p>.skip(数字) 跳过指定数量</p><p>.limit(数字)限制查询条数</p><p>.count() 统计总数量</p><p>不够：百度或谷歌</p><h2 id="■mongodb-聚合查询" tabindex="-1">■MongoDB 聚合查询 <a class="header-anchor" href="#■mongodb-聚合查询" aria-label="Permalink to &quot;■MongoDB 聚合查询&quot;">​</a></h2><h3 id="明确相关需求" tabindex="-1">明确相关需求 <a class="header-anchor" href="#明确相关需求" aria-label="Permalink to &quot;明确相关需求&quot;">​</a></h3><p><img src="`+c+`" alt="1585472901948"></p><p>思考：如何统计数据、如何实现分组统计等？</p><p>回答：通过 MongoDB 聚合查询</p><h3 id="概念" tabindex="-1">概念 <a class="header-anchor" href="#概念" aria-label="Permalink to &quot;概念&quot;">​</a></h3><p>聚合查询</p><p>顾名思义就是把数据聚起来，然后统计</p><h3 id="语法-略复杂" tabindex="-1">语法(略复杂 <a class="header-anchor" href="#语法-略复杂" aria-label="Permalink to &quot;语法(略复杂&quot;">​</a></h3><p>语法</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.集合名称.aggregate([</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span><span style="color:#61AFEF;">管道:</span><span style="color:#98C379;">{表达式}</span><span style="color:#61AFEF;">}</span></span>
<span class="line"><span style="color:#56B6C2;">     ....</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>常用管道</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E06C75;">$group</span><span style="color:#ABB2BF;"> 将集合中的文档分组，用于统计结果</span></span>
<span class="line"><span style="color:#E06C75;">$match</span><span style="color:#ABB2BF;"> 过滤数据，只要输出符合条件的文档</span></span>
<span class="line"><span style="color:#E06C75;">$sort</span><span style="color:#ABB2BF;">  聚合数据进一步排序</span></span>
<span class="line"><span style="color:#E06C75;">$skip</span><span style="color:#ABB2BF;">  跳过指定文档数</span></span>
<span class="line"><span style="color:#E06C75;">$limit</span><span style="color:#ABB2BF;"> 限制集合数据返回文档数</span></span>
<span class="line"><span style="color:#56B6C2;">....</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>常用表达式</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E06C75;">$sum</span><span style="color:#ABB2BF;">  总和  </span><span style="color:#E06C75;">$sum</span><span style="color:#ABB2BF;">:1同count表示统计</span></span>
<span class="line"><span style="color:#E06C75;">$avg</span><span style="color:#ABB2BF;">  平均</span></span>
<span class="line"><span style="color:#E06C75;">$min</span><span style="color:#ABB2BF;">  最小值</span></span>
<span class="line"><span style="color:#E06C75;">$max</span><span style="color:#ABB2BF;">  最大值</span></span>
<span class="line"><span style="color:#56B6C2;">...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="查询前准备" tabindex="-1">查询前准备 <a class="header-anchor" href="#查询前准备" aria-label="Permalink to &quot;查询前准备&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> test4</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:1,name:</span><span style="color:#61AFEF;">&quot;a&quot;</span><span style="color:#61AFEF;">,sex:1,age:1}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:2,name:</span><span style="color:#61AFEF;">&quot;a&quot;</span><span style="color:#61AFEF;">,sex:1,age:2}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:3,name:</span><span style="color:#61AFEF;">&quot;b&quot;</span><span style="color:#61AFEF;">,sex:2,age:3}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:4,name:</span><span style="color:#61AFEF;">&quot;c&quot;</span><span style="color:#61AFEF;">,sex:2,age:4}</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{_id:5,name:</span><span style="color:#61AFEF;">&quot;d&quot;</span><span style="color:#61AFEF;">,sex:2,age:5}</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><table tabindex="0"><thead><tr><th></th><th></th><th>统计</th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="练习" tabindex="-1">练习 <a class="header-anchor" href="#练习" aria-label="Permalink to &quot;练习&quot;">​</a></h3><ul><li>统计男生、女生的总年龄</li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.c1.aggregate([</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#E06C75;">        $group</span><span style="color:#98C379;">:{</span></span>
<span class="line"><span style="color:#61AFEF;">            _id:</span><span style="color:#98C379;"> &quot;</span><span style="color:#E06C75;">$sex</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">            rs:</span><span style="color:#98C379;"> {</span><span style="color:#E06C75;">$sum</span><span style="color:#98C379;">:</span><span style="color:#98C379;"> &quot;</span><span style="color:#E06C75;">$age</span><span style="color:#98C379;">&quot;}</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="`+i+`" alt="1585473992676"></p></blockquote><ul><li>统计男生、女生的总人数</li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.c1.aggregate([</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#E06C75;">        $group</span><span style="color:#98C379;">:{</span></span>
<span class="line"><span style="color:#61AFEF;">            _id:</span><span style="color:#98C379;"> &quot;</span><span style="color:#E06C75;">$sex</span><span style="color:#98C379;">&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">            rs:</span><span style="color:#98C379;"> {</span><span style="color:#E06C75;">$sum</span><span style="color:#98C379;">:1}</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="`+b+`" alt="1585474123142"></p></blockquote><ul><li>求学生总数和平均年龄</li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.c1.aggregate([</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#E06C75;">        $group</span><span style="color:#98C379;">:{</span></span>
<span class="line"><span style="color:#61AFEF;">            _id:</span><span style="color:#98C379;"> null,</span></span>
<span class="line"><span style="color:#61AFEF;">            total_num:</span><span style="color:#98C379;"> {</span><span style="color:#E06C75;">$sum</span><span style="color:#98C379;">:1},</span></span>
<span class="line"><span style="color:#61AFEF;">            total_avg:</span><span style="color:#98C379;"> {</span><span style="color:#E06C75;">$avg</span><span style="color:#98C379;">:</span><span style="color:#98C379;"> &quot;</span><span style="color:#E06C75;">$age</span><span style="color:#98C379;">&quot;}</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="`+u+`" alt="1585474285569"></p></blockquote><ul><li>查询男生、女生人数，按人数升序</li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.c1.aggregate([</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span><span style="color:#E06C75;">$group</span><span style="color:#ABB2BF;">:{</span><span style="color:#61AFEF;">_id:</span><span style="color:#98C379;"> &quot;</span><span style="color:#E06C75;">$sex</span><span style="color:#98C379;">&quot;,rs:</span><span style="color:#98C379;"> {</span><span style="color:#E06C75;">$sum</span><span style="color:#98C379;">:</span><span style="color:#D19A66;"> 1</span><span style="color:#98C379;">}}},</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span><span style="color:#E06C75;">$sort</span><span style="color:#ABB2BF;">:{</span><span style="color:#61AFEF;">rs:</span><span style="color:#D19A66;"> -1</span><span style="color:#ABB2BF;">}}</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="`+d+'" alt="1585474498560"></p></blockquote><h2 id="■mongodb-优化索引" tabindex="-1">■MongoDB 优化索引 <a class="header-anchor" href="#■mongodb-优化索引" aria-label="Permalink to &quot;■MongoDB 优化索引&quot;">​</a></h2><h3 id="生活中的索引" tabindex="-1">生活中的索引 <a class="header-anchor" href="#生活中的索引" aria-label="Permalink to &quot;生活中的索引&quot;">​</a></h3><p><img src="'+m+'" alt="1585474692372"></p><h3 id="数据库中的索引" tabindex="-1">数据库中的索引 <a class="header-anchor" href="#数据库中的索引" aria-label="Permalink to &quot;数据库中的索引&quot;">​</a></h3><ul><li><p>说明：索引是一种排序好的便于快速查询的数据结构</p></li><li><p>作用：帮助数据库高校的查询数据</p></li></ul><p><img src="'+y+`" alt="1585475724394"></p><h3 id="索引优缺点" tabindex="-1">索引优缺点 <a class="header-anchor" href="#索引优缺点" aria-label="Permalink to &quot;索引优缺点&quot;">​</a></h3><ul><li>优点</li></ul><blockquote><p>提高数据查询的效率，降低数据库的 IO 成本 通过索引对数据进行排序，降低数据排序的成本，降低 CPU 的消耗</p></blockquote><ul><li>缺点</li></ul><blockquote><p>占用磁盘空间 大量索引影响 SQL 语句效率，因为每次插入和修改数据都需要更新索引</p></blockquote><h3 id="语法" tabindex="-1">语法 <a class="header-anchor" href="#语法" aria-label="Permalink to &quot;语法&quot;">​</a></h3><ul><li>创建索引语法：db.集合名.createIndex(待创建索引的列 [,额外选项])</li><li>参数：</li></ul><blockquote><p>待创建索引的列：{键:1,...,键:-1} 说明：1 升序 -1 降序 例如{age:1}表示创建 age 索引并按照升序的方式存储 额外选项：设置索引的名称或者唯一索引等等</p></blockquote><ul><li>删除索引语法：</li></ul><blockquote><p>全部删除：db.集合名.dropIndexes()</p><p>删除指定：db.集合名.dropIndex(索引名)</p></blockquote><ul><li>查看索引语法：db.集合名.getIndexes()</li></ul><h3 id="删除练习" tabindex="-1">删除练习 <a class="header-anchor" href="#删除练习" aria-label="Permalink to &quot;删除练习&quot;">​</a></h3><p><strong>准备</strong>：向数据库中新增十万条数据</p><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">//选择数据库</span></span>
<span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> test5</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#61AFEF;">//向数据库中添加数据</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">var</span><span style="color:#98C379;"> i=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#61AFEF;">i</span><span style="color:#ABB2BF;">&lt;100000;</span><span style="color:#61AFEF;">i++</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#61AFEF;">db.c1.insert(</span><span style="color:#98C379;">{</span><span style="color:#ABB2BF;">&#39;</span><span style="color:#61AFEF;">name</span><span style="color:#61AFEF;">&#39;:&quot;aaa&quot;+i,&quot;age&quot;:i});</span></span>
<span class="line"><span style="color:#61AFEF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></blockquote><p><strong>创建普通索引</strong>：</p><blockquote><p>需 求：给 name 添加普通索引</p><p>练习 1：给 name 添加普通索引，命令：db.c1.createIndex({name:1})</p><p><img src="`+F+'" alt="1585476182255"></p><p>练习 2：删除 name 索引，命令：db.c1.dropIndex(&#39;name_1&#39;)</p><p><img src="'+g+'" alt="1585476235731"></p><p>练习 3：给 name 创建索引并起名 webopenfather</p><p>命令：db.c1.createIndex({name:1}, {name: &quot;webopenfather&quot;})</p><p><img src="'+h+'" alt="1585476311406"></p></blockquote><p><strong>创建复合/组合索引</strong>：</p><blockquote><p>需求：给 name 和 age 添加组合索引</p><p>说明：就是一次性给两个字段建立索引</p><p>语法：db.集合名.createIndex({键 1:方式,键 2:方式})</p><p><img src="'+A+'" alt="1585476428632"></p></blockquote><p><strong>创建唯一索引</strong>：</p><blockquote><p>需 求：给 name 添加普通索引</p><p>语 法：db.集合名.createIndex(待添加索引的列， {unique: 列名})</p><p>练习 1：删除全部索引，命令：db.c1.dropIndexes();</p><p><img src="'+B+'" alt="1585476535470"></p><p>练习 2：设置唯一索引，命令：db.c1.createIndex({name:1}, {unique: &quot;name&quot;})</p><p><img src="'+q+'" alt="1585476576207"></p><p>练习 3：测试唯一索引特性，</p><p>命 令： db.c1.insert({name: &quot;a&quot;}); db.c1.insert({name: &quot;a&quot;});</p><p><img src="'+E+'" alt="1585476763631"></p></blockquote><h3 id="分析索引-explain" tabindex="-1">分析索引（explain） <a class="header-anchor" href="#分析索引-explain" aria-label="Permalink to &quot;分析索引（explain）&quot;">​</a></h3><ul><li><p>语法：db.集合名.find().explain(&#39;executionStats&#39;)</p></li><li><p>说明：</p></li></ul><blockquote><p><img src="'+C+'" alt="1585461681918"> COLLSCAN 全表扫描 IXSCAN 索引扫描 FETCH 根据索引去检索指定 document</p></blockquote><ul><li>练习</li></ul><blockquote><p>测试：age 未添加索引情况 语法：db.c1.find({age:18}).explain(&#39;executionStats&#39;);</p><p><img src="'+k+'" alt="1585477310460"></p><p>测试：age 添加索引情况 语法：db.c1.createIndex({age: 1}) 继续：db.c1.find({age:18}).explain(&#39;executionStats&#39;) <img src="'+_+`" alt="1585477412871"></p></blockquote><h3 id="选择规则-如何选择合适的列创建索引" tabindex="-1">选择规则（如何选择合适的列创建索引） <a class="header-anchor" href="#选择规则-如何选择合适的列创建索引" aria-label="Permalink to &quot;选择规则（如何选择合适的列创建索引）&quot;">​</a></h3><p>-为常做条件、排序、分组的字段建立索引 -选择唯一性索引 （ps. 同值较少如性别字段） -选择较小的数据列，为较长的字符串使用前缀索引 （ps. 索引文件更小）</p><h2 id="■mongodb-权限机制" tabindex="-1">■MongoDB 权限机制 <a class="header-anchor" href="#■mongodb-权限机制" aria-label="Permalink to &quot;■MongoDB 权限机制&quot;">​</a></h2><h3 id="明确需要添加索引的需求" tabindex="-1">明确需要添加索引的需求 <a class="header-anchor" href="#明确需要添加索引的需求" aria-label="Permalink to &quot;明确需要添加索引的需求&quot;">​</a></h3><p>发现我们再 DOS 窗口直接输入命令就可以登录数据库</p><p>这在实战工作中绝对不允许的</p><p>思考：如何解决</p><p>回答：使用权限机制，开启验证模式即可</p><h3 id="语法-略难" tabindex="-1">语法(略难 <a class="header-anchor" href="#语法-略难" aria-label="Permalink to &quot;语法(略难&quot;">​</a></h3><p>创建账号</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">db.createUser(</span><span style="color:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;user&quot;</span><span style="color:#98C379;"> :</span><span style="color:#98C379;"> &quot;账号&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;pwd&quot;</span><span style="color:#56B6C2;">:</span><span style="color:#98C379;"> &quot;密码&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;roles&quot;</span><span style="color:#98C379;"> :</span><span style="color:#ABB2BF;"> [{</span></span>
<span class="line"><span style="color:#61AFEF;">        role:</span><span style="color:#98C379;"> &quot;角色&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">        db:</span><span style="color:#98C379;"> &quot;所属数据库&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }]</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>角色</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#角色种类</span></span>
<span class="line"><span style="color:#61AFEF;">超级用户角色：root</span></span>
<span class="line"><span style="color:#61AFEF;">数据库用户角色：read、readWrite</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#61AFEF;">数据库管理角色：dbAdmin、userAdmin；</span></span>
<span class="line"><span style="color:#61AFEF;">集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；</span></span>
<span class="line"><span style="color:#61AFEF;">备份恢复角色：backup、restore；</span></span>
<span class="line"><span style="color:#61AFEF;">所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#角色说明</span></span>
<span class="line"><span style="color:#61AFEF;">root：只在admin数据库中可用。超级账号，超级权限；</span></span>
<span class="line"><span style="color:#56B6C2;">read</span><span style="color:#98C379;">：允许用户读取指定数据库；</span></span>
<span class="line"><span style="color:#61AFEF;">readWrite：允许用户读写指定数据库；</span></span>
<span class="line"><span style="color:#61AFEF;">dbAdmin：允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile；</span></span>
<span class="line"><span style="color:#61AFEF;">dbAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限；</span></span>
<span class="line"><span style="color:#61AFEF;">clusterAdmin：只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限；</span></span>
<span class="line"><span style="color:#61AFEF;">userAdmin：允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户；</span></span>
<span class="line"><span style="color:#61AFEF;">userAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的userAdmin权限；</span></span>
<span class="line"><span style="color:#61AFEF;">readAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读权限；</span></span>
<span class="line"><span style="color:#61AFEF;">readWriteAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读写权限；</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="开启验证模式" tabindex="-1">开启验证模式 <a class="header-anchor" href="#开启验证模式" aria-label="Permalink to &quot;开启验证模式&quot;">​</a></h3><p><strong>开启验证模式概念</strong>： 名词，指用户需要输入账号密码才能登陆使用</p><p><strong>操作步骤</strong>：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">1.</span><span style="color:#98C379;"> 添加超级管理员</span></span>
<span class="line"><span style="color:#61AFEF;">2.</span><span style="color:#98C379;"> 退出卸载服务</span></span>
<span class="line"><span style="color:#61AFEF;">3.</span><span style="color:#98C379;"> 重新安装需要输入账号密码的服务（注在原安装命令基础上加上--auth即可</span></span>
<span class="line"><span style="color:#61AFEF;">4.</span><span style="color:#98C379;"> 启动服务</span><span style="color:#ABB2BF;"> -&gt; </span><span style="color:#98C379;">登陆测试</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>步骤 1：添加超级管理员</strong>：</p><blockquote><p>mongo</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> admin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">db.createUser(</span><span style="color:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;user&quot;</span><span style="color:#98C379;"> :</span><span style="color:#98C379;"> &quot;admin&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;pwd&quot;</span><span style="color:#56B6C2;">:</span><span style="color:#98C379;"> &quot;admin888&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;roles&quot;</span><span style="color:#98C379;"> :</span><span style="color:#ABB2BF;"> [{</span></span>
<span class="line"><span style="color:#61AFEF;">        role:</span><span style="color:#98C379;"> &quot;root&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">        db:</span><span style="color:#98C379;"> &quot;admin&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }]</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>脚下留心：2.x 3.x 4.x 前面版本默认是看不到 admin 没关系 你直接选中即可</p></blockquote><p><strong>步骤 2：退出卸载服务</strong>：</p><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">bin\\mongod</span><span style="color:#D19A66;"> --remove</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>脚下留心：DOS 窗口必须用管理员省份运行</p><p><img src="`+v+'" alt="1585478949532"></p></blockquote><p><strong>步骤 3：安装需要身份验证的 MongoDB 服务</strong>：</p><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">bin\\mongod</span><span style="color:#D19A66;"> --install</span><span style="color:#D19A66;"> --dbpath</span><span style="color:#98C379;"> E:</span><span style="color:#56B6C2;">\\m</span><span style="color:#98C379;">ongodb</span><span style="color:#56B6C2;">\\d</span><span style="color:#98C379;">ata</span><span style="color:#D19A66;"> --logpath</span><span style="color:#98C379;"> E:</span><span style="color:#56B6C2;">\\m</span><span style="color:#98C379;">ongodb</span><span style="color:#56B6C2;">\\l</span><span style="color:#98C379;">ogs</span><span style="color:#56B6C2;">\\m</span><span style="color:#98C379;">ongodb2.log</span><span style="color:#D19A66;"> --auth</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+x+'" alt="1585479066717"></p></blockquote><p><strong>步骤 4：启动服务 -&gt; 登录测试</strong>：</p><blockquote><p><img src="'+D+'" alt="1585479128562"></p></blockquote><h3 id="通过超级管理员账号登陆" tabindex="-1">通过超级管理员账号登陆 <a class="header-anchor" href="#通过超级管理员账号登陆" aria-label="Permalink to &quot;通过超级管理员账号登陆&quot;">​</a></h3><ul><li>方法 1：mongo 服务器 IP 地址:端口/数据库 -u 用户名 -p 密码</li></ul><blockquote><p><img src="'+f+'" alt="1585479276933"></p><p><img src="'+N+'" alt="1585479291125"></p></blockquote><ul><li>方法 2：a-先登录，b-选择数据库，c-输入 db.auth(用户名,密码)</li></ul><blockquote><p><img src="'+L+`" alt="1585479528999"></p></blockquote><h3 id="管理员权限练习" tabindex="-1">管理员权限练习 <a class="header-anchor" href="#管理员权限练习" aria-label="Permalink to &quot;管理员权限练习&quot;">​</a></h3><ul><li><strong>需求</strong></li></ul><blockquote><p>添加用户 shop1 可以读 shop 数据库 添加用户 shop2 可以读写 shop 数据库 脚下留心：必须在对应数据库创建用户</p></blockquote><ul><li>**准备：**创建测试数据和测试用户（注：选择 shop 仓库创建用户）</li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> shop</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">var</span><span style="color:#98C379;"> i=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">; </span><span style="color:#61AFEF;">i</span><span style="color:#ABB2BF;">&lt;=10; </span><span style="color:#61AFEF;">i++</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#61AFEF;">    db.goods.insert(</span><span style="color:#98C379;">{</span><span style="color:#ABB2BF;">&quot;</span><span style="color:#61AFEF;">name</span><span style="color:#61AFEF;">&quot;:&quot;</span><span style="color:#61AFEF;">goodsName</span><span style="color:#61AFEF;">&quot;+i,&quot;</span><span style="color:#61AFEF;">price</span><span style="color:#61AFEF;">&quot;:i});</span></span>
<span class="line"><span style="color:#61AFEF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></blockquote><ul><li><strong>添加用户并设置权限</strong></li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">//切记</span></span>
<span class="line"><span style="color:#61AFEF;">use</span><span style="color:#98C379;"> shop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">//shop1</span></span>
<span class="line"><span style="color:#61AFEF;">db.createUser(</span><span style="color:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;user&quot;</span><span style="color:#98C379;"> :</span><span style="color:#98C379;"> &quot;shop1&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;pwd&quot;</span><span style="color:#56B6C2;">:</span><span style="color:#98C379;"> &quot;admin888&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;roles&quot;</span><span style="color:#98C379;"> :</span><span style="color:#ABB2BF;"> [{</span></span>
<span class="line"><span style="color:#61AFEF;">        role:</span><span style="color:#98C379;"> &quot;read&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">        db:</span><span style="color:#98C379;"> &quot;shop&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }]</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">//shop2</span></span>
<span class="line"><span style="color:#61AFEF;">db.createUser(</span><span style="color:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;user&quot;</span><span style="color:#98C379;"> :</span><span style="color:#98C379;"> &quot;shop2&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;pwd&quot;</span><span style="color:#56B6C2;">:</span><span style="color:#98C379;"> &quot;admin888&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">    &quot;roles&quot;</span><span style="color:#98C379;"> :</span><span style="color:#ABB2BF;"> [{</span></span>
<span class="line"><span style="color:#61AFEF;">        role:</span><span style="color:#98C379;"> &quot;readWrite&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;">        db:</span><span style="color:#98C379;"> &quot;shop&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }]</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></blockquote><ul><li><strong>验证：shop1 可读</strong></li></ul><blockquote><p><img src="`+P+'" alt="1585479805712"></p></blockquote><ul><li><strong>验证：shop2 验证可读可写</strong></li></ul><blockquote><p><img src="'+w+`" alt="1585479857883"></p></blockquote><h2 id="■mongodb-备份还原" tabindex="-1">■MongoDB 备份还原 <a class="header-anchor" href="#■mongodb-备份还原" aria-label="Permalink to &quot;■MongoDB 备份还原&quot;">​</a></h2><h3 id="明确数据库备份的需求" tabindex="-1">明确数据库备份的需求 <a class="header-anchor" href="#明确数据库备份的需求" aria-label="Permalink to &quot;明确数据库备份的需求&quot;">​</a></h3><p>在实战工作中一定要做好数据库备份工作</p><p>否则万一数据丢失</p><p>带来的影响是巨大的</p><h3 id="备份数据库-mongodump" tabindex="-1">备份数据库 mongodump <a class="header-anchor" href="#备份数据库-mongodump" aria-label="Permalink to &quot;备份数据库 mongodump&quot;">​</a></h3><ul><li><strong>语法</strong></li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">导出数据语法：mongodump</span><span style="color:#D19A66;"> -h</span><span style="color:#D19A66;"> -port</span><span style="color:#D19A66;"> -u</span><span style="color:#D19A66;"> -p</span><span style="color:#D19A66;"> -d</span><span style="color:#D19A66;"> -o</span></span>
<span class="line"><span style="color:#61AFEF;">导出语法说明</span></span>
<span class="line"><span style="color:#61AFEF;">-h</span><span style="color:#98C379;">         host</span><span style="color:#98C379;">  服务器IP地址（一般不写</span><span style="color:#98C379;"> 默认本机</span></span>
<span class="line"><span style="color:#61AFEF;">-port</span><span style="color:#98C379;">           端口（一般不写</span><span style="color:#98C379;"> 默认27017</span></span>
<span class="line"><span style="color:#61AFEF;">-u</span><span style="color:#98C379;">     user</span><span style="color:#98C379;">   账号</span></span>
<span class="line"><span style="color:#61AFEF;">-p</span><span style="color:#98C379;">      pwd</span><span style="color:#98C379;">   密码</span></span>
<span class="line"><span style="color:#61AFEF;">-d</span><span style="color:#98C379;">  database</span><span style="color:#98C379;">  数据库（留心：数据库不写则导出全局</span></span>
<span class="line"><span style="color:#61AFEF;">-o</span><span style="color:#98C379;">     open</span><span style="color:#98C379;">   备份到指定目录下</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></blockquote><ul><li><strong>练习(备份所有数据)</strong>：mongodump -u admin -p admin888 -o E:\\mongodb\\bak</li></ul><blockquote><p><img src="`+M+'" alt="1585480505097"></p></blockquote><ul><li><strong>练习(备份指定数据)</strong>：mongodump -u admin -p admin888 -d shop -o E:\\mongodb\\bak2</li></ul><blockquote><p><img src="'+$+`" alt="1585480639789"></p></blockquote><h3 id="还原数据库-mongorestore" tabindex="-1">还原数据库 mongorestore <a class="header-anchor" href="#还原数据库-mongorestore" aria-label="Permalink to &quot;还原数据库 mongorestore&quot;">​</a></h3><ul><li><strong>语法：</strong></li></ul><blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">还原数据语法：mongorestore</span><span style="color:#D19A66;"> -h</span><span style="color:#D19A66;"> -port</span><span style="color:#D19A66;"> -u</span><span style="color:#D19A66;"> -p</span><span style="color:#D19A66;">  -d</span><span style="color:#D19A66;"> --drop</span><span style="color:#98C379;"> 备份数据目录</span></span>
<span class="line"><span style="color:#61AFEF;">还原数据说明：</span></span>
<span class="line"><span style="color:#61AFEF;">-h</span></span>
<span class="line"><span style="color:#61AFEF;">-port</span></span>
<span class="line"><span style="color:#61AFEF;">-u</span></span>
<span class="line"><span style="color:#61AFEF;">-p</span></span>
<span class="line"><span style="color:#61AFEF;">-d</span><span style="color:#98C379;">       不写则还原全部数据库</span></span>
<span class="line"><span style="color:#61AFEF;">--drop</span><span style="color:#98C379;">   先删除数据库再导入</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></blockquote><ul><li><strong>练习(还原所有数据)</strong>：mongorestore -u admin -p admin888 --drop E:\\mongodb\\bak</li></ul><blockquote><p><img src="`+I+'" alt="1585480881340"></p><p><img src="'+S+'" alt="1585480948534"></p><p><img src="'+W+'" alt="1585480971194"></p><p><img src="'+T+'" alt="1585480981182"></p></blockquote><ul><li><strong>练习(还原指定数据)</strong>：mongorestore -u shop2 -p admin888 -d shop --drop E:\\mongodb\\bak2\\shop</li></ul><blockquote><p><img src="'+H+'" alt="1585481050097"></p><p><img src="'+O+'" alt="1585481783387"></p></blockquote>',146)]))}const R=n(Q,[["render",U]]);export{Y as __pageData,R as default};
