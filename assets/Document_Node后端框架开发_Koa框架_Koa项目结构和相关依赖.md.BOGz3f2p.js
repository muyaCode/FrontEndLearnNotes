import{_ as n,c as a,o as l,ah as p}from"./chunks/framework.DqD713j2.js";const F=JSON.parse('{"title":"Koa 项目结构和相关依赖","description":"","frontmatter":{},"headers":[],"relativePath":"Document/Node后端框架开发/Koa框架/Koa项目结构和相关依赖.md","filePath":"Document/Node后端框架开发/Koa框架/Koa项目结构和相关依赖.md","lastUpdated":1750954157000}'),e={name:"Document/Node后端框架开发/Koa框架/Koa项目结构和相关依赖.md"};function o(r,s,t,c,i,B){return l(),a("div",null,s[0]||(s[0]=[p(`<h1 id="koa-项目结构和相关依赖" tabindex="-1">Koa 项目结构和相关依赖 <a class="header-anchor" href="#koa-项目结构和相关依赖" aria-label="Permalink to &quot;Koa 项目结构和相关依赖&quot;">​</a></h1><p>Koa 依赖  <strong>node v7.6.0</strong>  或 ES2015 及更高版本和 async 方法支持.</p><p>你可以使用自己喜欢的版本管理器(nvm/)快速安装支持的 node 版本：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">nvm</span><span style="color:#98C379;"> install</span><span style="color:#D19A66;"> 7</span></span>
<span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#98C379;"> i</span><span style="color:#98C379;"> koa</span></span>
<span class="line"><span style="color:#61AFEF;">node</span><span style="color:#98C379;"> my-koa-app.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="koa-项目结构" tabindex="-1">koa 项目结构 <a class="header-anchor" href="#koa-项目结构" aria-label="Permalink to &quot;koa 项目结构&quot;">​</a></h2><p>第一种</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">bin</span></span>
<span class="line"><span style="color:#61AFEF;">config</span></span>
<span class="line"><span style="color:#61AFEF;">node_modules</span></span>
<span class="line"><span style="color:#61AFEF;">server</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__database</span><span style="color:#98C379;">    //</span><span style="color:#98C379;"> 数据库目录</span></span>
<span class="line"><span style="color:#ABB2BF;">        |</span><span style="color:#61AFEF;">__schema</span><span style="color:#98C379;">    //</span><span style="color:#98C379;"> 构建schema目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__decorator</span><span style="color:#98C379;">   //</span><span style="color:#98C379;"> 装饰器目录，如router.js路由的装饰</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__middleware</span><span style="color:#98C379;">  //</span><span style="color:#98C379;"> 中间件目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__routes</span><span style="color:#98C379;">    //</span><span style="color:#98C379;"> 路由方法目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__service</span><span style="color:#98C379;">   //</span><span style="color:#98C379;"> 服务方法目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__task</span><span style="color:#98C379;">  //</span><span style="color:#98C379;"> 异步等或任务运行脚本方法目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__tpl</span><span style="color:#98C379;">  //</span><span style="color:#98C379;"> 模板目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__views</span><span style="color:#98C379;">  //</span><span style="color:#98C379;"> 模板渲染的页面目录</span></span>
<span class="line"><span style="color:#61AFEF;">src</span><span style="color:#98C379;">   //</span><span style="color:#98C379;"> 正常的前端项目目录</span></span>
<span class="line"><span style="color:#ABB2BF;">    |</span><span style="color:#61AFEF;">__assets</span><span style="color:#98C379;">  //</span><span style="color:#98C379;"> 静态资源目录</span></span>
<span class="line"><span style="color:#56B6C2;">    ...</span></span>
<span class="line"><span style="color:#61AFEF;">app.js</span><span style="color:#98C379;">    //</span><span style="color:#98C379;"> 入口运行目录</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>第二种</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____controllers</span><span style="color:#98C379;">                  //</span><span style="color:#98C379;"> 控制器目录</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____database</span><span style="color:#98C379;">                     //</span><span style="color:#98C379;"> 数据库目录</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____models</span><span style="color:#98C379;">                       //</span><span style="color:#98C379;"> 模型目录</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____public</span><span style="color:#98C379;">                       //</span><span style="color:#98C379;"> 公共静态资源文件目录</span></span>
<span class="line"><span style="color:#ABB2BF;">| |</span><span style="color:#61AFEF;">____1.jpg</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____routes</span><span style="color:#98C379;">                       //</span><span style="color:#98C379;"> 路由目录</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____src</span><span style="color:#98C379;">                          //</span><span style="color:#98C379;"> source</span><span style="color:#98C379;"> 文件</span></span>
<span class="line"><span style="color:#ABB2BF;">| |</span><span style="color:#61AFEF;">____index.js</span></span>
<span class="line"><span style="color:#ABB2BF;">| |</span><span style="color:#61AFEF;">____api</span><span style="color:#98C379;">                        //</span><span style="color:#98C379;"> api</span><span style="color:#98C379;"> 接口文件目录</span></span>
<span class="line"><span style="color:#ABB2BF;">| | |</span><span style="color:#61AFEF;">____a.js</span></span>
<span class="line"><span style="color:#ABB2BF;">| | |</span><span style="color:#61AFEF;">____b.js</span></span>
<span class="line"><span style="color:#ABB2BF;">| |</span><span style="color:#61AFEF;">____routes</span><span style="color:#98C379;">                     //</span><span style="color:#98C379;"> routes</span><span style="color:#98C379;"> 路由目录</span></span>
<span class="line"><span style="color:#ABB2BF;">| | |</span><span style="color:#61AFEF;">____aRouter.js</span></span>
<span class="line"><span style="color:#ABB2BF;">| | |</span><span style="color:#61AFEF;">____routes.js</span></span>
<span class="line"><span style="color:#ABB2BF;">| | |</span><span style="color:#61AFEF;">____bRouter.js</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____views</span><span style="color:#98C379;">                        //</span><span style="color:#98C379;"> 视图目录</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____app.js</span><span style="color:#98C379;">                       //</span><span style="color:#98C379;"> 入口文件</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____package-lock.json</span></span>
<span class="line"><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">____package.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>第三种</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">├─src</span><span style="color:#98C379;">           //</span><span style="color:#98C379;"> 应用目录（可设置）</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─controller</span><span style="color:#98C379;">                 //</span><span style="color:#98C379;"> 控制器</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─config</span><span style="color:#98C379;">                      //</span><span style="color:#98C379;"> 配置文件</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─db</span><span style="color:#98C379;">                           //</span><span style="color:#98C379;"> 数据库相关配置</span></span>
<span class="line"><span style="color:#61AFEF;">    ├─</span><span style="color:#98C379;"> model</span><span style="color:#98C379;">                     //</span><span style="color:#98C379;"> 各个数据模型</span></span>
<span class="line"><span style="color:#61AFEF;">    ├─</span><span style="color:#98C379;"> index.js</span><span style="color:#98C379;">                   //</span><span style="color:#98C379;"> 数据库配置页面</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─middleWares</span><span style="color:#98C379;">           //</span><span style="color:#98C379;"> 中间件</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─routes</span><span style="color:#98C379;">                      //</span><span style="color:#98C379;"> 路由</span></span>
<span class="line"><span style="color:#61AFEF;">    ├─</span><span style="color:#98C379;"> index.js</span><span style="color:#98C379;">                   //</span><span style="color:#98C379;"> 路由入口文件</span></span>
<span class="line"><span style="color:#61AFEF;">    ├─</span><span style="color:#98C379;"> users.js</span><span style="color:#98C379;">                  //</span><span style="color:#98C379;"> 用户路由</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─service</span><span style="color:#98C379;">                    //</span><span style="color:#98C379;"> 服务</span></span>
<span class="line"><span style="color:#61AFEF;">│</span><span style="color:#98C379;">  ├─app.js</span><span style="color:#98C379;">                   //</span><span style="color:#98C379;"> 入口文件</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>第四种(推荐使用)</strong>：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">config</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 配置文件，例如：database.config.js</span></span>
<span class="line"><span style="color:#61AFEF;">controller</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 控制器</span></span>
<span class="line"><span style="color:#61AFEF;">decorator</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 装饰器</span><span style="color:#98C379;"> 如</span><span style="color:#98C379;"> decorator/routes.js：对路由拆分和继承的功能方法</span></span>
<span class="line"><span style="color:#61AFEF;">models</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 数据库模型（ROM）</span></span>
<span class="line"><span style="color:#61AFEF;">middlewares</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 中间件</span></span>
<span class="line"><span style="color:#61AFEF;">public</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 静态资源</span></span>
<span class="line"><span style="color:#61AFEF;">service</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 服务-跟数据库进行交互</span></span>
<span class="line"><span style="color:#61AFEF;">static</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 静态资源目录</span></span>
<span class="line"><span style="color:#61AFEF;">router</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 路由</span></span>
<span class="line"><span style="color:#61AFEF;">routes</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 路由装饰器</span></span>
<span class="line"><span style="color:#61AFEF;">app.js</span><span style="color:#98C379;"> -</span><span style="color:#98C379;"> 启动文件</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="koa-依赖" tabindex="-1">Koa 依赖 <a class="header-anchor" href="#koa-依赖" aria-label="Permalink to &quot;Koa 依赖&quot;">​</a></h2><p>koa-generator 库： 使用  <code>koa-generator</code>  生成  <code>koa</code>  项目</p><ul><li><p>babel-core/babel-preset-es2015 - 让 nodeJs 支持 es6 modules</p></li><li><p>koa - koa2</p></li><li><p>koa-body - request body 解析</p><ul><li><p><a href="https://www.npmjs.com/package/koa-body" target="_blank" rel="noreferrer">koa-body - npm (npmjs.com)</a></p></li><li><p>使用示例：</p></li><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul></li><li><p><strong>koa-bodyparser</strong> - request body 解析</p><ul><li><p><a href="https://www.npmjs.com/package/koa-bodyparser" target="_blank" rel="noreferrer">koa-bodyparser - npm (npmjs.com)</a></p></li><li><p><strong>koa-bodyparser 使用示例：</strong></p></li><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> Koa</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;koa&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> bodyParser</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;koa-bodyparser&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> app</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Koa</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 禁用正文解析器：可以通过设置动态禁用正文解析器。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ctx.disableBodyParser = true</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">ctx</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">next</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">path</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;/disable&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#E5C07B;">ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">disableBodyParser</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#61AFEF;"> next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 使用解析和相关配置</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">bodyParser</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 自定义 JSON 请求检测函数。默认值为null</span></span>
<span class="line"><span style="color:#E06C75;">    detectJSON</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">ctx</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#E06C75;"> /</span><span style="color:#56B6C2;">\\.</span><span style="color:#E06C75;">json</span><span style="color:#C678DD;">$</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">i</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">test</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 支持扩展类型，或者[&#39;json&#39;, &#39;form&#39;]：json/form/text/xml</span></span>
<span class="line"><span style="color:#E06C75;">    extendTypes</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;">      json</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&#39;application/x-javascript&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 支持自定义错误句柄，如果抛出错误，可以自定义响应，如：koa-bodyparser</span></span>
<span class="line"><span style="color:#E06C75;">    onerror</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">ctx</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">      ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">throw</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;body parse error&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">422</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // encoding: (ctx) =&gt; {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // }</span></span>
<span class="line"><span style="color:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">async</span><span style="color:#E06C75;font-style:italic;"> ctx</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 解析后的body将存储在ctx. request中</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 如果没有解析任何内容，body将是一个空对象{}</span></span>
<span class="line"><span style="color:#E5C07B;">  ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">request</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div></li></ul></li><li><p>@koa/multer - formData 解析(文件上传)-处理使用<a href="https://github.com/expressjs/multer" target="_blank" rel="noreferrer">multer</a>  的 Koa 路由中间件</p><ul><li><a href="https://www.npmjs.com/package/@koa/multer" target="_blank" rel="noreferrer">@koa/multer - npm (npmjs.com)</a></li><li><a href="https://github.com/koajs/multer" target="_blank" rel="noreferrer">koajs/multer: Middleware for handling <code>multipart/form-data</code> for koa, based on Express&#39;s multer. (github.com)</a></li></ul></li><li><p>koa-cache-control - 缓存控制</p></li><li><p>koa-compress - gzip</p></li><li><p>koa-cors - 跨域</p></li><li><p>koa-logger - 日志</p></li><li><p>koa-onerror - 错误处理</p></li><li><p><strong>koa-router - 路由</strong></p><ul><li>npm：<a href="https://www.npmjs.com/package/koa-router" target="_blank" rel="noreferrer">koa-router - npm (npmjs.com)</a></li><li>koa-router 的 API 文档：<a href="https://github.com/koajs/router/blob/HEAD/API.md" target="_blank" rel="noreferrer">router/API.md koajs/router (github.com)</a></li></ul></li><li><p>koa-session - session</p></li><li><p>koa-static - 静态资源服务</p><ul><li><p><a href="https://www.npmjs.com/package/koa-static" target="_blank" rel="noreferrer">koa-static - npm (npmjs.com)</a></p></li><li><p>使用案例：</p><ul><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> Koa</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;koa&quot;</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 引入koa</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> app</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Koa</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">// 创建koa应用</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> static</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;koa-static&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 可以配置多个文件夹，这个文件夹找不到就找下一个文件夹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 相对路径</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">static</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./static&quot;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 绝对路径</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#61AFEF;">	static</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__dirname</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;/public&quot;</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// 默认为true  访问的文件为index.html，可以修改为别的文件名或者false</span></span>
<span class="line"><span style="color:#E06C75;">		index</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// 是否同意传输隐藏文件</span></span>
<span class="line"><span style="color:#E06C75;">		hidden</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// 如果为true，则在返回next()之后进行服务，从而允许后续中间件先进行响应</span></span>
<span class="line"><span style="color:#E06C75;">		defer</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">listen</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li><li><p>访问时不需要加上 pubilc，即 “<a href="http://127.0.0.1:3000/%E6%96%87%E4%BB%B6%E5%90%8D%E2%80%9D" target="_blank" rel="noreferrer">http://127.0.0.1:3000/文件名”</a> 这种形式访问</p></li></ul></li></ul></li><li><p>koa-static-cache - 静态缓存</p><ul><li><a href="https://www.npmjs.com/package/koa-static-cache" target="_blank" rel="noreferrer">koa-static-cache - npm (npmjs.com)</a></li></ul></li><li><p>koa-swig - 模板引擎，非侵入式，6 年未更新（推荐使用 pug 库）</p><ul><li><a href="https://www.npmjs.com/package/koa-swig" target="_blank" rel="noreferrer">koa-swig - npm (npmjs.com)</a></li></ul></li><li><p><strong>pug - 模板引擎，(jade) 侵入式，配合 koa-view 使用</strong></p><ul><li>官网：<a href="https://pugjs.org/api/getting-started.html" target="_blank" rel="noreferrer">Getting Started – Pug (pugjs.org)</a></li><li>中文网：<a href="https://www.pugjs.cn/api/getting-started.html" target="_blank" rel="noreferrer">入门指南 – Pug 模板引擎中文文档 | Pug 中文网 (pugjs.cn)</a></li></ul></li><li><p>ejs - 模板引擎，非侵入式</p><ul><li><p>官网：<a href="https://ejs.co/index.html" target="_blank" rel="noreferrer">EJS -- Embedded JavaScript templates</a></p></li><li><p>中文网：<a href="https://ejs.bootcss.com/" target="_blank" rel="noreferrer">EJS -- 嵌入式 JavaScript 模板引擎 | EJS 中文文档 (bootcss.com)</a></p></li><li><p><strong>使用示例：</strong></p></li><li><p>1.在 app.js 通过 koa-views 注册使用 ejs 模板引擎</p></li><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> views</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;koa-views&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 如果这样配置，模板的后缀为.html</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">views</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;views&quot;</span><span style="color:#ABB2BF;">, { </span><span style="color:#E06C75;">map</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ejs&quot;</span><span style="color:#ABB2BF;"> } }));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 如果这样配置，模板的后缀为.ejs</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// app.use(views(&#39;views&#39;, { extension: &#39;ejs&#39; }));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2.Koa 的路由或 app.use 中间件中向模板引擎传递数据：<code>await ctx.render(&#39;页面&#39;,{ 数据 })</code></p></li><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">router</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/add&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">ctx</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> title</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;hello koa2&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 传递数据title</span></span>
<span class="line"><span style="color:#C678DD;">	await</span><span style="color:#E5C07B;"> ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">render</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;index&quot;</span><span style="color:#ABB2BF;">, { </span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;"> });</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p>3.模板中使用路由传递过来的数据</p></li><li><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#E06C75;">DOCTYPE</span><span style="color:#D19A66;"> html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">html</span><span style="color:#D19A66;"> lang</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;en&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">meta</span><span style="color:#D19A66;"> charset</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">		&lt;</span><span style="color:#ABB2BF;">--! 引入ejs模板 --&gt; </span><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">% include public/header.ejs%&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		这是一个ejs的模板引擎 </span><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">--! Ejs 绑定数据title --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;标题---</span><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%=title%&gt;&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>引入的模板：public/header.ejs</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">h1</span><span style="color:#D19A66;"> class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;title&quot;</span><span style="color:#ABB2BF;">&gt;这是一个头部的模块&lt;/</span><span style="color:#E06C75;">h1</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>4.views/目录的 html 文件中使用模板语法</p></li><li><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#E06C75;">DOCTYPE</span><span style="color:#D19A66;"> html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">html</span><span style="color:#D19A66;"> lang</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;en&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">meta</span><span style="color:#D19A66;"> charset</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">--! 引入ejs模板 --&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">% include public/header.ejs%&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">--! Ejs 绑定数据title --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;标题---</span><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%=title%&gt;&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">--! js 模板中循环数据 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">ul</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">    &lt;</span><span style="color:#ABB2BF;">%for(var i=0;i&lt;</span><span style="color:#E06C75;">list.length;i++){%</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">li</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%=list[i]%&gt;&lt;/</span><span style="color:#E06C75;">li</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">    &lt;</span><span style="color:#ABB2BF;">%}%&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">ul</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">br</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%=content%&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">br</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">--! Ejs 模板判断语句 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;条件判断&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">br</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%if(num&gt;24){%&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;"> 大于24</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%}else{%&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">小于24</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%}%&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">br</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">% if(true){ %&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;true&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%} else{ %&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;false&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;</span><span style="color:#ABB2BF;">%} %&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></li></ul></li><li><p>art-template - 模板引擎，轻量，号称最快速编译的模板引擎</p><ul><li><p>文档：<a href="http://aui.github.io/art-template/zh-cn/index.html" target="_blank" rel="noreferrer">art-template (aui.github.io)</a></p></li><li><p><strong>Koa 使用：<a href="http://aui.github.io/art-template/koa/" target="_blank" rel="noreferrer">Koa - art-template (aui.github.io)</a></strong></p></li></ul></li><li><p>dkoa-view - 静态文件访问能力</p><ul><li><p><a href="https://www.npmjs.com/package/koa-view" target="_blank" rel="noreferrer">koa-view - npm (npmjs.com)</a></p></li><li><p>使用示例：可以配合上面的模板引擎使用</p></li><li><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> view</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;koa-view&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 使用模板引擎pug，如果是ejs，也可以把pug替换成ejs</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// views 第一个参数：静态页面的路径 第二个参数配置对象</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 参数配置对象opts文档configure：http://mozilla.github.io/nunjucks/cn/api.html#configure</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">views</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__dirname</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;/views&#39;</span><span style="color:#ABB2BF;">, { </span><span style="color:#E06C75;">extension</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;pug&#39;</span><span style="color:#ABB2BF;"> }));));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 中间件中传递渲染的数据</span></span>
<span class="line"><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">use</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">async</span><span style="color:#E06C75;font-style:italic;"> ctx</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">  ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">state</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">    session</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">session</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;app&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // ctx.render() 是使用app.use(views())模板渲染的koa-view库注入的</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 用于传递要渲染的数据方法</span></span>
<span class="line"><span style="color:#C678DD;">  await</span><span style="color:#E5C07B;"> ctx</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">render</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;user&#39;</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 传递对象属性user可以直接在：views/user.pug使用，[h1= user]</span></span>
<span class="line"><span style="color:#E06C75;">    user</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;Coder&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">  });</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li><li><p>md5 - md5 加密</p></li><li><p>Parcel - 零配置的构建打包工具，能够处理打包包裹各种框架语言或者文件</p><ul><li>官网：<a href="https://parceljs.org/" target="_blank" rel="noreferrer">Parcel (parceljs.org)</a></li><li>Parcel 1 中文网：<a href="https://www.parceljs.cn/getting_started.html" target="_blank" rel="noreferrer">🚀 快速开始 | Parcel 中文网 (parceljs.cn)</a></li><li>Parcel 2 中文网：<a href="https://v2.parceljs.cn/" target="_blank" rel="noreferrer">Parcel 中文文档 | Parcel 中文网 (parceljs.cn)</a></li></ul></li><li><p>mkdirp - 递归创建目录</p></li><li><p>koa-helmet - 安全</p></li><li><p><strong>项目热重载运行</strong></p></li><li><p>nodemon - 项目热重载运行库：每次修改代码后，自动重启项目</p><ul><li><p>项目安装：npm install nodemon --save-dev</p><ul><li><strong>项目安装启动</strong>：<code>npx nodemon app.js</code></li></ul></li><li><p>全局安装：npm install nodemon -g</p><ul><li><strong>全局安装启动项目</strong>：<code>nodemon app.js</code></li></ul></li></ul></li><li><p>supervisor - 项目热重载运行库：每次修改代码后，自动重启项目 - supervisor app.js</p><ul><li><p><strong>项目安装</strong>：npm install supervisor --save-dev</p><ul><li>项目安装启动：<code>npx supervisor app.js</code></li></ul></li><li><p><strong>全局安装</strong>：npm install supervisor -g</p><ul><li>全局安装启动项目：<code>supervisor app.js</code></li></ul></li></ul></li></ul>`,16)]))}const b=n(e,[["render",o]]);export{F as __pageData,b as default};
